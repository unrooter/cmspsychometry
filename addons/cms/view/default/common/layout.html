<!DOCTYPE html>
<!--[if lt IE 7]>
<html class="lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>
<html class="lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>
<html class="lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!-->
<html class="" lang="zh-CN"> <!--<![endif]-->
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,Chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0">
    <meta name="renderer" content="webkit">
    <title>{cms:config name="cms.title|htmlentities"/} - {cms:config name="cms.sitename"/}</title>
    <meta name="keywords" content="{cms:config name='cms.keywords|htmlentities'/}"/>
    <meta name="description" content="{cms:config name='cms.description|htmlentities'/}"/>

    <link rel="shortcut icon" href="__CDN__/favicon.ico" type="image/x-icon"/>
    
    <!-- 性能优化：DNS预连接和资源预加载 -->
    <link rel="preconnect" href="https://cdnjs.cloudflare.com" crossorigin>
    <link rel="preconnect" href="https://pagead2.googlesyndication.com" crossorigin>
    <link rel="preconnect" href="https://adservice.google.com" crossorigin>
    <link rel="preconnect" href="https://googleads.g.doubleclick.net" crossorigin>
    <link rel="preconnect" href="https://api.nbmgkj.com" crossorigin>
    <link rel="dns-prefetch" href="//cdnjs.cloudflare.com">
    <link rel="dns-prefetch" href="//pagead2.googlesyndication.com">
    <link rel="dns-prefetch" href="//adservice.google.com">
    <link rel="dns-prefetch" href="//googleads.g.doubleclick.net">
    <link rel="dns-prefetch" href="//api.nbmgkj.com">
    <!-- 内联最小关键CSS，防止FOUC -->
    <style>
    body{margin:0;font-family:ui-sans-serif,system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans","Liberation Sans",sans-serif;opacity:0;transition:opacity 0.3s ease-in}
    body.loaded{opacity:1}
    
    /* 页面加载动画 */
    #page-loader{position:fixed;top:0;left:0;width:100%;height:100%;background:#fff;z-index:99999;display:flex;align-items:center;justify-content:center;transition:opacity 0.3s ease-out,visibility 0.3s ease-out}
    #page-loader.hidden{opacity:0;visibility:hidden}
    .loader-spinner{width:50px;height:50px;border:4px solid #f3f3f3;border-top:4px solid #5CB89F;border-radius:50%;animation:spin 0.8s linear infinite}
    @keyframes spin{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}

    /* 移动端菜单（配合 .active class 切换） */
    #navbar-collapse{transform:translateX(-100%);transition:transform 0.25s ease;width:16rem;z-index:50;overflow-y:auto;-webkit-overflow-scrolling:touch}
    #navbar-collapse.active{transform:translateX(0)}
    body.is-open{overflow:hidden}
    .navbar-collapse-bg{position:fixed;inset:0;background:rgba(0,0,0,.5);z-index:40}
    </style>

    {php}$__twver = @filemtime(ROOT_PATH . 'public/assets/addons/cms/css/tailwind.min.css');{/php}
    <link rel="stylesheet" href="__ADDON__/css/tailwind.min.css?v={$__twver ?: $site.version}">
    <noscript><link rel="stylesheet" href="__ADDON__/css/tailwind.min.css?v={$__twver ?: $site.version}"></noscript>
    
    <!-- 字体预加载（防止CLS布局偏移） -->
    <link rel="preload" href="__CDN__/assets/libs/font-awesome/fonts/fontawesome-webfont.woff2?v=4.7.0" as="font" type="font/woff2" crossorigin>
    
    <!-- LCP图片预加载（关键性能优化） -->
    <link rel="preload" as="image" href="/uploads/simpleimages/117.jpg" fetchpriority="high">
    
    <!-- 预加载关键JavaScript（减少解析延迟） -->
    <link rel="modulepreload" href="__CDN__/assets/libs/jquery/dist/jquery.min.js?v={$site.version}">
    
    <!-- 非关键CSS延迟加载 -->
    <link rel="stylesheet" href="__CDN__/assets/libs/font-awesome/css/font-awesome.min.css?v={$site.version}">
    <link rel="stylesheet" href="__ADDON__/css/iconfont.css?v={$site.version}">
    <link rel="stylesheet" href="__ADDON__/css/swiper.min.css?v={$site.version}">
    
    <!-- 降级方案（无JS时正常加载） -->
    <noscript>
        <link rel="stylesheet" media="screen" href="__CDN__/assets/libs/font-awesome/css/font-awesome.min.css?v={$site.version}"/>
        <link rel="stylesheet" media="screen" href="__ADDON__/css/iconfont.css?v={$site.version}">
    </noscript>

    <!-- <link rel="stylesheet" href="https://unpkg.com/element-ui/lib/theme-chalk/index.css"> -->
    <!--分享 - Open Graph-->
    <meta property="og:type" content="website"/>
    <meta property="og:title" content="{cms:config name='cms.title|htmlentities'/}"/>
    <meta property="og:image" content="{cms:config name='cms.image|htmlentities'/}"/>
    <meta property="og:image:width" content="1200"/>
    <meta property="og:image:height" content="630"/>
    <meta property="og:description" content="{cms:config name='cms.description|htmlentities'/}"/>
    <meta property="og:url" content="{$Think.request.domain}{$Think.request.url}"/>
    <meta property="og:site_name" content="{cms:config name='cms.sitename'/}"/>
    
    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image"/>
    <meta name="twitter:title" content="{cms:config name='cms.title|htmlentities'/}"/>
    <meta name="twitter:description" content="{cms:config name='cms.description|htmlentities'/}"/>
    <meta name="twitter:image" content="{cms:config name='cms.image|htmlentities'/}"/>
    
    <!-- 多语言SEO优化 -->
    <meta name="language" content="{if $Think.cookie.frontend_language == 'en'}en{else}zh{/if}"/>
    <meta name="geo.region" content="CN"/>
    <meta name="geo.placename" content="China"/>
    
    <!-- 针对文章详情页的SEO优化 -->
    {if isset($__ARCHIVES__)}
    {php}$fullUrl = (isset($_SERVER['HTTPS']) && $_SERVER['HTTPS'] === 'on' ? "https" : "http") . "://" . $_SERVER['HTTP_HOST'] . $__ARCHIVES__['url'];{/php}
    <link rel="canonical" href="{$fullUrl}"/>
    <link rel="alternate" hreflang="zh-CN" href="{$fullUrl}"/>
    <link rel="alternate" hreflang="en" href="{$fullUrl}?lg=en"/>
    <link rel="alternate" hreflang="x-default" href="{$fullUrl}"/>
    
    <meta name="description" content="{:htmlentities($__ARCHIVES__['description'] ?: $__ARCHIVES__['sub_title'])}"/>
    <meta name="keywords" content="{:htmlentities($__ARCHIVES__['keywords'] ?? '')}"/>
    <meta name="author" content="{cms:config name='cms.sitename'/}"/>
    <meta name="robots" content="index,follow"/>
    
    <!-- Open Graph 文章专用标签 -->
    <meta property="og:type" content="article"/>
    <meta property="og:title" content="{:htmlentities($__ARCHIVES__['title'] ?? '')}"/>
    <meta property="og:description" content="{:htmlentities($__ARCHIVES__['sub_title'] ?: $__ARCHIVES__['description'])}"/>
    <meta property="og:image" content="{:cdnurl($__ARCHIVES__['image'] ?? '')}"/>
    <meta property="og:url" content="{$fullUrl}"/>
    <meta property="article:published_time" content="{$__ARCHIVES__.publishtime|date='c',###}"/>
    <meta property="article:modified_time" content="{$__ARCHIVES__.updatetime|date='c',###}"/>
    <meta property="article:author" content="{cms:config name='cms.sitename'/}"/>
    {if $__ARCHIVES__.tags}
    {volist name="__ARCHIVES__.tags" id="tag"}
    <meta property="article:tag" content="{$tag.title}"/>
    {/volist}
    {/if}
    
    <!-- Twitter Card 文章专用 -->
    <meta name="twitter:card" content="summary_large_image"/>
    <meta name="twitter:title" content="{:htmlentities($__ARCHIVES__['title'] ?? '')}"/>
    <meta name="twitter:description" content="{:htmlentities($__ARCHIVES__['sub_title'] ?: $__ARCHIVES__['description'])}"/>
    <meta name="twitter:image" content="{:cdnurl($__ARCHIVES__['image'] ?? '')}"/>
    
    {elseif isset($__CHANNEL__)}
    <!-- 针对频道页的SEO优化 -->
    {php}$fullUrl = (isset($_SERVER['HTTPS']) && $_SERVER['HTTPS'] === 'on' ? "https" : "http") . "://" . $_SERVER['HTTP_HOST'] . $__CHANNEL__['url'];{/php}
    <link rel="canonical" href="{$fullUrl}"/>
    <link rel="alternate" hreflang="zh-CN" href="{$fullUrl}"/>
    <link rel="alternate" hreflang="en" href="{$fullUrl}?lg=en"/>
    <link rel="alternate" hreflang="x-default" href="{$fullUrl}"/>
    
    {php}
    $channelDesc = !empty($__CHANNEL__['description']) ? $__CHANNEL__['description'] : '探索' . $__CHANNEL__['name'] . '相关的心理测试，深入了解自我';
    $channelKeywords = !empty($__CHANNEL__['keywords']) ? $__CHANNEL__['keywords'] : $__CHANNEL__['name'] . ',心理测试,自我认知';
    $channelOgDesc = !empty($__CHANNEL__['description']) ? $__CHANNEL__['description'] : '探索' . $__CHANNEL__['name'] . '相关的心理测试';
    {/php}
    
    <meta name="description" content="{$channelDesc|htmlentities}"/>
    <meta name="keywords" content="{$channelKeywords|htmlentities}"/>
    <meta name="robots" content="index,follow"/>
    
    <!-- Open Graph 频道页专用 -->
    <meta property="og:type" content="website"/>
    <meta property="og:title" content="{$__CHANNEL__.seotitle ?: $__CHANNEL__.name} - {cms:config name='cms.sitename'/}"/>
    <meta property="og:description" content="{$channelOgDesc|htmlentities}"/>
    <meta property="og:url" content="{$__CHANNEL__.url}"/>
    {if $__CHANNEL__.image}
    <meta property="og:image" content="{$__CHANNEL__.image|cdnurl}"/>
    {/if}
    
    <!-- Twitter Card 频道页 -->
    <meta name="twitter:card" content="summary"/>
    <meta name="twitter:title" content="{$__CHANNEL__.seotitle ?: $__CHANNEL__.name}"/>
    <meta name="twitter:description" content="{$channelOgDesc|htmlentities}"/>
    {/if}

    {__STYLE__}

    <!--[if lt IE 9]>
    <script src="__CDN__/libs/html5shiv.js"></script>
    <script src="__CDN__/libs/respond.min.js"></script>
    <![endif]-->
    <!-- Google AdSense 脚本 - 立即加载以确保广告显示 -->
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-9195262048954682"
            crossorigin="anonymous"></script>
     
    {cms:block name="header" field="content" /}
    
    <!-- JSON-LD 结构化数据 - 网站信息 -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "WebSite",
      "name": "{cms:config name='cms.sitename'/}",
      "url": "{$Think.request.domain}",
      "description": "{cms:config name='cms.description|htmlentities'/}",
      "inLanguage": ["{if $Think.cookie.frontend_language == 'en'}en{else}zh-CN{/if}"],
      "potentialAction": {
        "@type": "SearchAction",
        "target": {
          "@type": "EntryPoint",
          "urlTemplate": "{$Think.request.domain}{:addon_url('cms/search/index')}?q={search_term_string}"
        },
        "query-input": "required name=search_term_string"
      }
    }
    </script>
    
    <!-- JSON-LD 结构化数据 - 组织信息 -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "Organization",
      "name": "{cms:config name='cms.sitename'/}",
      "url": "{$Think.request.domain}",
      "logo": "{$Think.config.cms.sitelogo|default='/assets/addons/cms/img/logo.png'|cdnurl}",
      "description": "{cms:config name='cms.description|htmlentities'/}",
      "sameAs": []
    }
    </script>
</head>
<body class="min-h-screen bg-white text-gray-900">

<!-- 页面加载动画 -->
<div id="page-loader">
    <div class="loader-spinner"></div>
</div>

<header class="sticky top-0 z-50 bg-white shadow">
    <!-- S 导航 -->
    <nav role="navigation">
        <div class="mx-auto flex max-w-6xl items-center justify-between px-4 py-3">
            <div class="flex items-center">
                <button type="button" class="sidebar-toggle mr-3 inline-flex h-10 w-10 items-center justify-center rounded-lg border border-gray-200 bg-white text-gray-700 shadow-sm active:scale-[0.98] md:hidden" aria-label="Toggle navigation">
                    <span class="sr-only">Toggle navigation</span>
                    <svg class="h-5 w-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
                        <line x1="3" y1="6" x2="21" y2="6"></line>
                        <line x1="3" y1="12" x2="21" y2="12"></line>
                        <line x1="3" y1="18" x2="21" y2="18"></line>
                    </svg>
                </button>
                <a class="inline-flex items-center" href="{cms:config name='cms.indexurl'/}" title="{cms:config name='cms.sitename'/} - {:__('返回首页')}">
                    <img class="h-10 w-10" src="{$Think.config.cms.sitelogo|default='/assets/addons/cms/img/logo.png'|cdnurl}" alt="{cms:config name='cms.sitename'/} - {:__('专业心理测试在线平台')}" width="40" height="40" loading="eager">
                    <span class="ml-2 hidden text-sm font-semibold text-gray-900 sm:block">{cms:config name="cms.sitename"/}</span>
                </a>
            </div>

            <div class="hidden items-center md:flex">
                <ul class="flex items-center" data-current="{$__CHANNEL__.id|default=0}">
                    {cms:channellist id="nav" type="top" condition="1=isnav"}
                    <li class="relative group mr-5 {if $nav->is_active}font-semibold text-emerald-600{/if}">
                        <a class="text-sm text-gray-700 hover:text-emerald-600" href="{$nav.url}">{:__($nav.name)}{if $nav.has_nav_child} <i class="fa fa-caret-down ml-1" aria-hidden="true"></i>{/if}</a>
                        <ul class="{if !$nav.has_nav_child}hidden{else}hidden group-hover:block{/if} absolute left-0 top-full z-50 mt-2 min-w-[10rem] rounded-md border border-gray-100 bg-white py-2 shadow-lg" role="menu">
                            {cms:channellist id="sub" type="son" typeid="nav['id']" condition="1=isnav"}
                            <li><a class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-50 hover:text-emerald-600" href="{$sub.url}">{:__($sub.name)}</a></li>
                            {/cms:channellist}
                        </ul>
                    </li>
                    {/cms:channellist}
                    {//cms:nav maxlevel="4" cache="86400" /}
                </ul>

                <form class="ml-6 hidden md:block" action="{:addon_url('cms/search/index')}" method="get">
                    <div class="relative">
                        <input class="h-10 w-64 rounded-full border border-gray-200 bg-white pl-10 pr-4 text-sm text-gray-900 placeholder:text-gray-400 focus:border-emerald-500 focus:outline-none focus:ring-2 focus:ring-emerald-100" name="q" data-suggestion-url="{:addon_url('cms/search/suggestion')}" type="search" id="searchinput" value="{$Think.request.q|default=''|htmlentities}" placeholder="{:__('搜索心理测试、文章...')}" aria-label="搜索" autocomplete="off">
                        <span class="pointer-events-none absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"><i class="fa fa-search" aria-hidden="true"></i></span>
                    </div>
                    {:token('__searchtoken__')}
                </form>

                <div class="relative ml-6">
                    <button type="button" class="inline-flex items-center gap-2 rounded-md px-2 py-2 text-sm text-gray-700 hover:bg-gray-50" aria-label="{:__('切换语言')}" data-dropdown-toggle="lang">
                        <i class="fa fa-globe" aria-hidden="true"></i>
                        <span>{if $Think.cookie.frontend_language == 'en'}English{else}中文{/if}</span>
                    </button>
                    <div class="absolute right-0 top-full z-50 hidden min-w-[10rem] rounded-md border border-gray-100 bg-white py-2 shadow-lg" data-dropdown-menu="lang">
                        <a href="?lang=zh-cn" onclick="switchLanguage('zh-cn'); return false;" class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-50 hover:text-emerald-600 {if $Think.cookie.frontend_language == 'zh-cn'}font-semibold text-emerald-600{/if}"><i class="fa fa-flag mr-2" aria-hidden="true"></i>中文</a>
                        <a href="?lang=en" onclick="switchLanguage('en'); return false;" class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-50 hover:text-emerald-600 {if $Think.cookie.frontend_language == 'en'}font-semibold text-emerald-600{/if}"><i class="fa fa-flag mr-2" aria-hidden="true"></i>English</a>
                    </div>
                </div>

                <div class="ml-6">
                    {if config('fastadmin.usercenter')}
                    <div class="relative">
                        {if $user}
                        <a class="inline-flex items-center gap-2 rounded-full border border-gray-200 px-3 py-2 text-sm text-gray-700 hover:bg-gray-50" href="{:url('index/user/index')}" data-dropdown-toggle="user">
                            <img class="h-7 w-7 rounded-full" src="{$user.avatar|cdnurl|htmlentities}" alt="{$user.nickname|htmlentities} - {:__('用户头像')}">
                            <span class="hidden sm:inline">{$user.nickname|htmlentities}</span>
                        </a>
                        {else /}
                        <a class="inline-flex items-center rounded-md border border-gray-200 px-3 py-2 text-sm text-gray-700 hover:bg-gray-50" href="{:url('index/user/index')}" data-dropdown-toggle="user">{:__('会员')}{:__('中心')}</a>
                        {/if}
                        <div class="absolute right-0 top-full z-50 mt-2 hidden min-w-[12rem] rounded-md border border-gray-100 bg-white py-2 shadow-lg" data-dropdown-menu="user">
                            {if $user}
                            <a class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-50 hover:text-emerald-600" href="{:url('index/user/index')}"><i class="fa fa-user mr-2" aria-hidden="true"></i>{:__('会员中心')}</a>
                            {php}$sidenav = array_filter(explode(',', config('cms.usersidenav')));{/php}
                            {if in_array('myorder', $sidenav)}
                           <!-- <li><a href="{:url('index/vip/viplist')}"><i class="fa fa-shopping-bag fa-fw"></i> 开通VIP</a></li> -->
                            {/if}
                            {if in_array('mycomment', $sidenav)}
                            <a class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-50 hover:text-emerald-600" href="{:url('index/cms.answer/index')}"><i class="fa fa-comments mr-2" aria-hidden="true"></i>测试记录</a>
                            {/if}
                            {if in_array('mycollection', $sidenav)}
                            <!-- <li><a href="{:url('index/cms.collection/index')}"><i class="fa fa-bookmark fa-fw"></i> 我的收藏</a></li> -->
                            {/if}
                            <a class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-50 hover:text-emerald-600" href="javascript:localStorage.removeItem('email_token'); window.location.href='{:url('index/user/logout')}';"><i class="fa fa-sign-out mr-2" aria-hidden="true"></i>退出</a>
                            {else /}
                            <a class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-50 hover:text-emerald-600" href="{:url('index/user/login')}"><i class="fa fa-sign-in mr-2" aria-hidden="true"></i>{:__('登录')}</a>
                            <a class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-50 hover:text-emerald-600" href="{:url('index/user/register')}"><i class="fa fa-user-o mr-2" aria-hidden="true"></i>{:__('注册')}</a>
                            {/if}
                        </div>
                    </div>
                    {/if}
                </div>
            </div>

            <div class="fixed inset-y-0 left-0 z-50 w-64 bg-white p-4 shadow-xl md:hidden" id="navbar-collapse">
                <div class="mb-4 flex items-center justify-between">
                    <span class="text-sm font-semibold text-gray-900">{cms:config name="cms.sitename"/}</span>
                    <button type="button" class="sidebar-toggle inline-flex h-10 w-10 items-center justify-center rounded-lg border border-gray-200 bg-white text-gray-700 shadow-sm active:scale-[0.98]" aria-label="Close navigation">
                        <svg class="h-5 w-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
                            <line x1="18" y1="6" x2="6" y2="18"></line>
                            <line x1="6" y1="6" x2="18" y2="18"></line>
                        </svg>
                    </button>
                </div>
                <form class="mb-4" action="{:addon_url('cms/search/index')}" method="get">
                    <div class="relative">
                        <input class="h-10 w-full rounded-full border border-gray-200 bg-white pl-10 pr-4 text-sm text-gray-900 placeholder:text-gray-400 focus:border-emerald-500 focus:outline-none focus:ring-2 focus:ring-emerald-100" name="q" data-suggestion-url="{:addon_url('cms/search/suggestion')}" type="search" value="{$Think.request.q|default=''|htmlentities}" placeholder="{:__('搜索心理测试、文章...')}" aria-label="搜索" autocomplete="off">
                        <span class="pointer-events-none absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"><i class="fa fa-search" aria-hidden="true"></i></span>
                    </div>
                    {:token('__searchtoken__')}
                </form>
                <ul class="space-y-2" data-current="{$__CHANNEL__.id|default=0}">
                    {cms:channellist id="nav" type="top" condition="1=isnav"}
                    <li>
                        <a class="block rounded-md px-3 py-2 text-sm text-gray-700 hover:bg-gray-50 hover:text-emerald-600 {if $nav->is_active}font-semibold text-emerald-600{/if}" href="{$nav.url}">{:__($nav.name)}</a>
                        <ul class="{if !$nav.has_nav_child}hidden{/if} mt-1 space-y-1 pl-3" role="menu">
                            {cms:channellist id="sub" type="son" typeid="nav['id']" condition="1=isnav"}
                            <li><a class="block rounded-md px-3 py-2 text-sm text-gray-600 hover:bg-gray-50 hover:text-emerald-600" href="{$sub.url}">{:__($sub.name)}</a></li>
                            {/cms:channellist}
                        </ul>
                    </li>
                    {/cms:channellist}
                </ul>
            </div>
        </div>
    </nav>
    <!-- E 导航 -->
</header>

<main class="min-h-[60vh]">
    {__CONTENT__}
</main>

<footer itemscope itemtype="https://schema.org/WPFooter">
    <div class="mt-12 bg-emerald-600 text-white">
        <div class="mx-auto max-w-6xl px-4 py-10">
            <div class="grid gap-8 md:grid-cols-2">
                <div class="flex gap-4">
                    <a class="text-white" href="{:addon_url('cms/index/index')}" title="{cms:config name='cms.sitename'/}" aria-label="返回首页"><i class="fa fa-bookmark fa-2x" aria-hidden="true"></i></a>
                    <div>
                        <h3 class="text-lg font-semibold">{cms:config name="cms.sitename"/}</h3>
                        <p class="mt-2 text-sm leading-7 text-white/90">
                            {:__('自我孵化心理测试平台是一个集合各种专业的心理估量表以及趣味测试的平台，致力于为用户提供高质量、专业且有趣的在线心理测试服务。通过这些测试，希望你能够在不同的角度更加了解自我。')}
                        </p>
                    </div>
                </div>
                <div class="md:text-right">
                    <nav aria-label="footer navigation">
                        <div class="flex flex-wrap gap-x-6 gap-y-2 md:justify-end">
                            <a class="text-sm text-white/90 hover:text-white" href="{:addon_url('cms/page/index', [':diyname'=>'aboutus'])}" title="关于我们">关于我们</a>
                            <a class="text-sm text-white/90 hover:text-white" href="{:addon_url('cms/page/index', [':diyname'=>'agreement'])}" title="用户协议">用户协议</a>
                            {if config('fastadmin.usercenter')}
                            <a class="text-sm text-white/90 hover:text-white" href="{:url('index/user/index')}" title="会员中心">会员中心</a>
                            {/if}
                            <a class="text-sm text-white/90 hover:text-white" href="{:addon_url('cms/search/index')}" title="搜索">搜索</a>
                        </div>
                    </nav>
                    <div class="mt-5 text-sm text-white/80">
                                <p class="my-1">Copyright&nbsp;©&nbsp;{:date("Y")} All rights reserved</p>
                                <p class="my-1">{cms:config name="cms.sitename"/}</p>
                                {if $site.beian}
                                <p class="my-1"><a href="https://beian.miit.gov.cn" target="_blank" rel="noopener noreferrer" class="text-white/80 hover:text-white">{$site.beian|htmlentities}</a></p>
                                {/if}
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</footer>

<!-- 返回顶部按钮 -->
<div id="back-to-top" aria-label="返回顶部" role="button" tabindex="0">
    <i class="fa fa-chevron-up"></i>
</div>


<!-- 关键JS：同步加载 -->
<script src="__CDN__/assets/libs/jquery/dist/jquery.min.js?v={$site.version}"></script>
<script>window.__CMS_TW_OFFCANVAS__ = true;</script>
<script src="__ADDON__/js/common.js?v={$site.version}"></script>

<script>
(function () {
    function closest(el, selector) {
        while (el && el.nodeType === 1) {
            if (el.matches(selector)) return el;
            el = el.parentElement;
        }
        return null;
    }

    var lastTouchTime = 0;

    function getCollapse() {
        return document.getElementById('navbar-collapse');
    }

    function removeBackdrop() {
        var bg = document.querySelector('.navbar-collapse-bg');
        if (bg && bg.parentNode) bg.parentNode.removeChild(bg);
    }

    function openMenu() {
        var collapse = getCollapse();
        if (!collapse) return;
        document.body.classList.add('is-open');
        collapse.classList.add('active');
        removeBackdrop();
        var bg = document.createElement('div');
        bg.className = 'navbar-collapse-bg';
        bg.addEventListener('click', function () {
            closeMenu();
        });
        collapse.insertAdjacentElement('afterend', bg);
    }

    function closeMenu() {
        var collapse = getCollapse();
        document.body.classList.remove('is-open');
        if (collapse) collapse.classList.remove('active');
        removeBackdrop();
    }

    function handleToggleEvent(e) {
        if (e.type === 'touchend') {
            lastTouchTime = Date.now();
        }
        if (e.type === 'click' && lastTouchTime && Date.now() - lastTouchTime < 600) {
            return;
        }
        var btn = closest(e.target, '.sidebar-toggle');
        if (!btn) return;
        e.preventDefault();
        e.stopImmediatePropagation();
        var collapse = getCollapse();
        if (!collapse) return;
        if (collapse.classList.contains('active')) {
            closeMenu();
        } else {
            openMenu();
        }
    }

    document.addEventListener('click', handleToggleEvent, true);
    document.addEventListener('touchend', handleToggleEvent, true);

    document.addEventListener('click', function (e) {
        var a = closest(e.target, '#navbar-collapse a');
        if (!a) return;
        if (window.innerWidth < 768) closeMenu();
    }, true);

    document.addEventListener('keydown', function (e) {
        if (e.key === 'Escape' || e.keyCode === 27) {
            var collapse = getCollapse();
            if (collapse && collapse.classList.contains('active')) {
                closeMenu();
            }
        }
    }, true);
})();
</script>

<script>
(function () {
    function closest(el, selector) {
        while (el && el.nodeType === 1) {
            if (el.matches(selector)) return el;
            el = el.parentElement;
        }
        return null;
    }

    function hideAll() {
        document.querySelectorAll('[data-dropdown-menu]').forEach(function (m) {
            m.classList.add('hidden');
        });
    }

    document.addEventListener('click', function (e) {
        var toggle = closest(e.target, '[data-dropdown-toggle]');
        if (toggle) {
            e.preventDefault();
            e.stopPropagation();
            var id = toggle.getAttribute('data-dropdown-toggle');
            if (!id) return;
            var menu = document.querySelector('[data-dropdown-menu="' + id + '"]');
            if (!menu) return;
            var isHidden = menu.classList.contains('hidden');
            hideAll();
            if (isHidden) menu.classList.remove('hidden');
            return;
        }
        hideAll();
    }, true);

    document.addEventListener('keydown', function (e) {
        if (e.key === 'Escape' || e.keyCode === 27) {
            hideAll();
        }
    }, true);
})();
</script>

<!-- 非关键JS：延迟加载 -->
<script defer src="__CDN__/assets/libs/fastadmin-layer/dist/layer.js?v={$site.version}"></script>
<script defer src="__CDN__/assets/libs/art-template/dist/template-native.js?v={$site.version}"></script>
<script defer src="__ADDON__/js/jquery.autocomplete.js?v={$site.version}"></script>
<script defer src="__ADDON__/js/swiper.min.js?v={$site.version}"></script>
<script defer src="__ADDON__/js/share.min.js?v={$site.version}"></script>
<script defer src="__ADDON__/js/cms.js?v={$site.version}"></script>
<script defer src="__ADDON__/js/libs.js?v={$site.version}"></script>

<!-- 多语言切换功能 -->
<script type="text/javascript">
// 语言切换功能
function switchLanguage(lang) {
    // 更新当前语言显示
    const langTexts = {
        'zh-cn': '中文',
        'en': 'English'
    };
    
    document.getElementById('current-lang-text').textContent = langTexts[lang] || '中文';
    
    // 设置cookie
    document.cookie = 'frontend_language=' + lang + '; path=/; max-age=31536000';
    
    // 构建新的URL
    const currentUrl = new URL(window.location.href);
    const currentPath = currentUrl.pathname;
    
    // 移除现有的语言参数
    currentUrl.searchParams.delete('lg');
    
    // 添加新的语言参数
    currentUrl.searchParams.set('lg', lang);
    
    // 如果是测试页面，同时更新API调用的语言参数
    if (window.location.pathname.includes('/MBTI/') || 
        window.location.pathname.includes('/xinling/') || 
        window.location.pathname.includes('/qinggan/') || 
        window.location.pathname.includes('/renge/') || 
        window.location.pathname.includes('/zhiye/')) {
        
        // 延迟跳转，让用户看到语言切换效果
        setTimeout(() => {
            window.location.href = currentUrl.toString();
        }, 300);
    } else {
        // 立即跳转
        window.location.href = currentUrl.toString();
    }
}

// 页面加载时初始化语言状态
document.addEventListener('DOMContentLoaded', function() {
    const currentLang = getCookie('frontend_language') || 'zh-cn';
    const langTexts = {
        'zh-cn': '中文',
        'en': 'English'
    };
    
    const currentLangText = document.getElementById('current-lang-text');
    if (currentLangText) {
        currentLangText.textContent = langTexts[currentLang] || '中文';
    }
    
    // 更新语言切换按钮的激活状态
    document.querySelectorAll('.lang-switch').forEach(link => {
        link.classList.remove('active');
        if (link.onclick.toString().includes(currentLang)) {
            link.classList.add('active');
        }
    });
});

// 获取Cookie的辅助函数
function getCookie(name) {
    const value = "; " + document.cookie;
    const parts = value.split("; " + name + "=");
    if (parts.length === 2) return parts.pop().split(";").shift();
}

// 返回顶部功能
const backToTopBtn = document.getElementById('back-to-top');

window.addEventListener('scroll', function() {
    if (window.pageYOffset > 300) {
        backToTopBtn.classList.add('show');
    } else {
        backToTopBtn.classList.remove('show');
    }
});

backToTopBtn.addEventListener('click', function() {
    window.scrollTo({
        top: 0,
        behavior: 'smooth'
    });
});

// 键盘访问支持
backToTopBtn.addEventListener('keypress', function(e) {
    if (e.key === 'Enter' || e.key === ' ') {
        e.preventDefault();
        window.scrollTo({
            top: 0,
            behavior: 'smooth'
        });
    }
});

// 优化导航活动状态
document.addEventListener('DOMContentLoaded', function() {
    const currentPath = window.location.pathname;
    const navLinks = document.querySelectorAll('.navbar-nav > li > a');
    
    navLinks.forEach(link => {
        if (link.getAttribute('href') === currentPath) {
            link.parentElement.classList.add('active');
        }
    });
});
</script>

{if $isWechat}
<script type="text/javascript" src="https://res.wx.qq.com/open/js/jweixin-1.6.0.js"></script>
{/if}


{cms:block name="footer" field="content" /}

<!-- 页面加载完成后隐藏loader -->
<script>
(function() {
    // 立即添加loaded类开始淡入
    document.body.classList.add('loaded');

    try {
        document.querySelectorAll('[data-css]').forEach(function (el) {
            var cssText = el.getAttribute('data-css');
            if (cssText) el.style.cssText = cssText;
        });
    } catch (e) {}
    
    // 等待DOM完全加载
    if (document.readyState === 'complete' || document.readyState === 'interactive') {
        hideLoader();
    } else {
        window.addEventListener('DOMContentLoaded', hideLoader);
    }
    
    // 备用：最多等待1秒后强制隐藏
    setTimeout(hideLoader, 1000);
    
    function hideLoader() {
        const loader = document.getElementById('page-loader');
        if (loader && !loader.classList.contains('hidden')) {
            loader.classList.add('hidden');
            // 动画完成后移除DOM元素
            setTimeout(function() {
                if (loader.parentNode) {
                    loader.parentNode.removeChild(loader);
                }
            }, 300);
        }
    }
})();
</script>
</body>
</html>
