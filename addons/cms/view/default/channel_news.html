{layout name="common/layout" /}

<!-- SEO结构化数据 -->
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "CollectionPage",
  "name": "{$__CHANNEL__.seotitle ?: $__CHANNEL__.name}",
  "description": "{$__CHANNEL__.description}",
  "url": "{$__CHANNEL__.url}"
}
</script>

<div class="mx-auto max-w-7xl px-4 sm:px-6 lg:px-8" id="content-container" itemscope itemtype="https://schema.org/CollectionPage">

    <nav aria-label="breadcrumb" class="mt-6">
        <ol class="flex flex-wrap items-center gap-x-2 gap-y-1 text-sm text-gray-600" itemscope itemtype="https://schema.org/BreadcrumbList">
            <!-- S 面包屑导航 -->
            {cms:breadcrumb id="item"}
            <li class="inline-flex items-center" itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
                <a class="hover:text-emerald-600" href="{$item.url}" itemprop="item"><span itemprop="name">{:__($item.name)}</span></a>
                <meta itemprop="position" content="{$i}" />
            </li>
            {/cms:breadcrumb}
            <!-- E 面包屑导航 -->
        </ol>
    </nav>

    <!-- 子栏目导航（仅父栏目显示子栏目） -->
    {php}$hasSubChannels = false;{/php}
    {cms:channellist id="subchan_check" type="son" typeid="$__CHANNEL__.id" limit="1"}
    {php}$hasSubChannels = true;{/php}
    {/cms:channellist}

    <header class="mt-4 rounded-lg border border-gray-200 bg-white p-5 shadow-sm">
        <div class="flex flex-wrap items-center gap-3">
            <h1 class="text-xl font-bold text-gray-900" itemprop="name">{:__($__CHANNEL__.name)}</h1>
        </div>

        {if $__CHANNEL__.description}
        <div class="mt-3 text-sm leading-7 text-gray-600" itemprop="description">{$__CHANNEL__.description}</div>
        {/if}

        {if $hasSubChannels}
        <nav class="mt-4 flex flex-wrap items-center gap-2" aria-label="{:__('栏目分类')}">
            <span class="inline-flex items-center gap-2 text-sm font-medium text-gray-700"><i class="fa fa-th-large" aria-hidden="true"></i>{:__('栏目分类')}</span>
            {cms:channellist id="subchan" type="son" typeid="$__CHANNEL__.id"}
            <a href="{$subchan.url}" class="rounded-full border border-gray-200 px-3 py-1 text-sm text-gray-700 hover:bg-gray-50 hover:text-emerald-600">{:__($subchan.name)}</a>
            {/cms:channellist}
        </nav>
        {/if}
    </header>

    <div class="mt-6 grid gap-6 lg:grid-cols-12">
        <main class="lg:col-span-8">
            <section aria-label="{:__('列表')}">
                <div class="rounded-lg border border-gray-200 bg-white shadow-sm">
                    <div class="flex flex-wrap items-center justify-between gap-3 border-b border-gray-100 px-4 py-3">
                        <h2 class="text-base font-semibold text-gray-900">{:__('列表')}</h2>
                        <div class="flex flex-wrap gap-2">
                            <!-- S 排序 -->
                            {cms:pageorder id="order"}
                            <a href="{$order.url}" class="rounded-full border border-gray-200 bg-white px-3 py-1 text-sm text-gray-700 hover:bg-gray-50 hover:text-emerald-600 {$order.active?'bg-emerald-50 text-emerald-700 border-emerald-200':''}">{$order.title|htmlentities}</a>
                            {/cms:pageorder}
                            <!-- E 排序 -->
                        </div>
                    </div>
                    <div class="p-4">
                        <div class="divide-y divide-gray-100" itemscope itemtype="https://schema.org/ItemList">
                            <meta itemprop="name" content="{:__($__CHANNEL__.name)}文章列表" />

                            <!-- S 列表 -->
                            {cms:pagelist id="item"}
                                {include file="common/item_news"}
                            {/cms:pagelist}
                            <!-- E 列表 -->
                        </div>

                        <!-- S 分页 -->
                        <div class="mt-8">
                            {include file="common/pageinfo" /}
                        </div>
                        <!-- E 分页 -->
                    </div>
                </div>
            </section>
        </main>

        <aside class="space-y-6 lg:col-span-4">
            <section aria-labelledby="related-articles-title">
                <div class="rounded-lg border border-gray-200 bg-white shadow-sm">
                    <h3 class="border-b border-gray-100 px-4 py-3 text-base font-semibold text-gray-900" id="related-articles-title"><i class="fa fa-star mr-2 text-emerald-600" aria-hidden="true"></i>{:__('相关推荐')}</h3>
                    <div class="space-y-3 p-4">
                        {cms:arclist id="item" channel="$__CHANNEL__.id" orderby="views" orderway="DESC" limit="4"}
                        <a href="{$item.url}" class="group block overflow-hidden rounded-md border border-gray-200 bg-white shadow-sm transition hover:shadow-md" title="{$item.title|htmlentities}">
                            <div class="aspect-[4/1] overflow-hidden bg-gray-100">
                                <img src="{$item.image ?: '/assets/addons/cms/img/default.png'}" alt="{$item.title|htmlentities}" loading="lazy" class="h-full w-full object-cover transition duration-300 group-hover:scale-105">
                            </div>
                            <div class="p-2 text-sm font-medium text-gray-900 truncate">{$item.title|htmlentities}</div>
                        </a>
                        {/cms:arclist}
                    </div>
                </div>
            </section>

            {include file="common/sidebar" /}
        </aside>
    </div>
</div>
