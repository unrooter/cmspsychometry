{layout name="common/layout" /}

<!-- SEO结构化数据 -->
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "CollectionPage",
  "name": "{$__CHANNEL__.seotitle ?: $__CHANNEL__.name}",
  "description": "{$__CHANNEL__.description}",
  "url": "{$__CHANNEL__.url}"
}
</script>

<div class="mx-auto max-w-7xl px-4 py-10 sm:px-6 lg:px-8" id="content-container" itemscope itemtype="https://schema.org/CollectionPage">

    <nav aria-label="breadcrumb" class="mb-6">
        <ol class="flex flex-wrap items-center gap-x-1.5 gap-y-1 text-xs text-gray-500" itemscope itemtype="https://schema.org/BreadcrumbList">
            <!-- S 面包屑导航 -->
            {php}$breadPos = 0;{/php}
            {cms:breadcrumb id="item"}
            {php}$breadPos++;{/php}
            <li class="inline-flex items-center" itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
                {if $breadPos>1}<span class="mx-1 text-gray-300">›</span>{/if}
                <a class="no-underline hover:text-black" href="{$item.url}" itemprop="item"><span itemprop="name">{:__($item.name)}</span></a>
                <meta itemprop="position" content="{$breadPos}" />
            </li>
            {/cms:breadcrumb}
            <!-- E 面包屑导航 -->
        </ol>
    </nav>

    <!-- 子栏目导航（仅父栏目显示子栏目） -->
    {php}$hasSubChannels = false;{/php}
    {cms:channellist id="subchan_check" type="son" typeid="$__CHANNEL__.id" limit="1"}
    {php}$hasSubChannels = true;{/php}
    {/cms:channellist}

    <header class="ui-card">
        <div class="ui-card-body">
            <div class="flex flex-wrap items-center gap-3">
                <h1 class="text-lg font-semibold tracking-tight text-gray-900" itemprop="name">{:__($__CHANNEL__.name)}</h1>
            </div>

            {if $__CHANNEL__.description}
            <div class="mt-3 text-sm leading-7 text-gray-700" itemprop="description">{$__CHANNEL__.description}</div>
            {/if}

            {if $hasSubChannels}
            <nav class="mt-4 flex flex-wrap items-center gap-2" aria-label="{:__('栏目分类')}">
                <span class="inline-flex items-center gap-2 text-xs font-semibold tracking-[0.14em] text-gray-800/90"><i class="fa fa-th-large" aria-hidden="true"></i>{:__('栏目分类')}</span>
                {cms:channellist id="subchan" type="son" typeid="$__CHANNEL__.id"}
                <a href="{$subchan.url}" class="ui-pill text-xs tracking-[0.14em] {if $subchan.id == $__CHANNEL__.id}ui-pill-active{/if}">{:__($subchan.name)}</a>
                {/cms:channellist}
            </nav>
            {/if}
        </div>
    </header>

    <div class="mt-6 grid gap-6 lg:grid-cols-12">
        <main class="lg:col-span-8">
            <section aria-label="{:__('列表')}">
                <div class="ui-card">
                    <div class="ui-card-header flex flex-wrap items-center justify-between gap-3">
                        <h2 class="text-xs font-semibold tracking-[0.18em] text-gray-900">{:__('列表')}</h2>
                        <div class="flex flex-wrap gap-2">
                            <!-- S 排序 -->
                            {cms:pageorder id="order"}
                            <a href="{$order.url}" class="ui-pill text-xs tracking-[0.14em] {$order.active?'ui-pill-active':''}">{$order.title|htmlentities}</a>
                            {/cms:pageorder}
                            <!-- E 排序 -->
                        </div>
                    </div>
                    <div class="ui-card-body">
                        <div class="divide-y divide-gray-100" itemscope itemtype="https://schema.org/ItemList">
                            <meta itemprop="name" content="{:__($__CHANNEL__.name)}文章列表" />

                            <!-- S 列表 -->
                            {cms:pagelist id="item"}
                                {include file="common/item_news"}
                            {/cms:pagelist}
                            <!-- E 列表 -->
                        </div>

                        <!-- S 分页 -->
                        <div class="mt-8">
                            {include file="common/pageinfo" /}
                        </div>
                        <!-- E 分页 -->
                    </div>
                </div>
            </section>
        </main>

        <aside class="space-y-6 lg:col-span-4">
            <section aria-labelledby="related-articles-title">
                <div class="ui-card">
                    <h3 class="ui-card-header text-xs font-semibold tracking-[0.18em] text-gray-900" id="related-articles-title"><i class="fa fa-star mr-2 text-black/60" aria-hidden="true"></i>{:__('相关推荐')}</h3>
                    <div class="space-y-3 p-4">
                        {cms:arclist id="item" channel="$__CHANNEL__.id" orderby="views" orderway="DESC" limit="4"}
                        <a href="{$item.url}" class="group block overflow-hidden rounded-none border border-black/10 bg-transparent transition" title="{$item.title|htmlentities}">
                            <div class="aspect-[4/1] overflow-hidden bg-black/5">
                                <img src="{$item.image ?: '/assets/addons/cms/img/default.png'}" alt="{$item.title|htmlentities}" loading="lazy" class="h-full w-full object-cover transition duration-300 group-hover:scale-105">
                            </div>
                            <div class="p-2 text-sm font-medium text-gray-900 truncate">{$item.title|htmlentities}</div>
                        </a>
                        {/cms:arclist}
                    </div>
                </div>
            </section>

            {include file="common/sidebar" /}
        </aside>
    </div>
</div>
