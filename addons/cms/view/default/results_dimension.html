{layout name="common/layout" /}
<!-- å¼•å…¥ Font Awesome -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
<!-- å¼•å…¥ Chart.js -->
<script src="https://cdn.jsdelivr.net/npm/chart.js@3.9.1/dist/chart.min.js"></script>

<!-- Google AdSense å¼‚æ­¥åŠ è½½è„šæœ¬ -->
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-YOUR_ADSENSE_ID"
     crossorigin="anonymous"></script>

<article class="min-h-screen bg-gray-50 py-6" itemscope itemtype="https://schema.org/TestResult">

    <!-- é¢åŒ…å±‘å¯¼èˆª - SEOä¼˜åŒ– -->
    <nav class="mx-auto max-w-5xl px-4 sm:px-6 lg:px-8" aria-label="Breadcrumb">
        <ol class="flex flex-wrap items-center gap-x-2 gap-y-1 rounded-lg border border-gray-200 bg-white px-4 py-3 text-sm text-gray-600 shadow-sm" itemscope itemtype="https://schema.org/BreadcrumbList">
            <li class="inline-flex items-center" itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
                <a href="/" class="hover:text-gray-900" itemprop="item"><span itemprop="name">é¦–é¡µ</span></a>
                <meta itemprop="position" content="1" />
            </li>
            <li class="inline-flex items-center" itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
                <span class="px-1 text-gray-400">â€º</span>
                <a href="/tests" class="hover:text-gray-900" itemprop="item"><span itemprop="name">å¿ƒç†æµ‹è¯•</span></a>
                <meta itemprop="position" content="2" />
            </li>
            <li class="inline-flex items-center" itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
                <span class="px-1 text-gray-400">â€º</span>
                <span class="font-semibold text-gray-900" itemprop="name">æµ‹è¯•ç»“æœ</span>
                <meta itemprop="position" content="3" />
            </li>
        </ol>
    </nav>

    <div class="mx-auto mt-6 max-w-5xl px-4 sm:px-6 lg:px-8">
        <div class="rounded-2xl bg-white p-6 shadow-sm ring-1 ring-gray-200 sm:p-8">
            <!-- æµ‹è¯•æ ‡é¢˜ -->
            <header class="rounded-2xl bg-gradient-to-br from-emerald-500 to-emerald-700 px-6 py-8 text-center text-white shadow-sm">
                <div class="text-3xl" aria-hidden="true">ğŸ¯</div>
                <h1 id="test-title" class="mt-3 text-2xl font-bold sm:text-3xl" itemprop="headline">æµ‹è¯•ç»“æœ</h1>
                <p id="test-subtitle" class="mt-2 text-sm opacity-95 sm:text-base" itemprop="description">æ„Ÿè°¢æ‚¨å®Œæˆæµ‹è¯•ï¼Œä»¥ä¸‹æ˜¯æ‚¨çš„è¯¦ç»†åˆ†ææŠ¥å‘Š</p>
            </header>

            <!-- æµ‹è¯•ä¿¡æ¯ - æŠ˜å å¼ -->
            <section class="mt-6 overflow-hidden rounded-2xl border border-gray-200 bg-gray-50" id="test-info">
                <button type="button" class="flex w-full items-center justify-between gap-3 px-5 py-4 text-left" onclick="toggleTestInfo()">
                    <h2 class="text-base font-semibold text-gray-900" id="info-header-title">æµ‹è¯•ä¿¡æ¯</h2>
                    <span class="text-sm font-semibold text-gray-500" id="test-info-icon">â–¼</span>
                </button>
                <div class="hidden px-5 pb-5" id="info-content">
                    <!-- æµ‹è¯•ä¿¡æ¯å°†åœ¨è¿™é‡Œæ˜¾ç¤º -->
                </div>
            </section>

            <!-- Google AdSense é¡¶éƒ¨æ¨ªå¹…å¹¿å‘Š -->
            <div class="mx-auto my-8 max-w-3xl text-center">
                <ins class="adsbygoogle block"
                     data-ad-client="ca-pub-9195262048954682"
                     data-ad-slot="2969657271"
                     data-ad-format="auto"
                     data-full-width-responsive="true"></ins>
                <script>
                (adsbygoogle = window.adsbygoogle || []).push({});
                </script>
            </div>

            <!-- ä¸»å¯¼ç±»å‹æ˜¾ç¤º -->
            <section class="mt-6">
                <div class="rounded-2xl bg-gradient-to-br from-indigo-500 to-purple-600 p-6 text-white shadow-sm">
                    <div class="text-center">
                        <div class="text-base font-semibold sm:text-lg" id="score-description">Loading...</div>
                        <div class="mt-2 text-sm opacity-90" id="score-level">Evaluating...</div>
                    </div>
                </div>
            </section>

            <!-- é›·è¾¾å›¾å±•ç¤º -->
            <section class="radar-section mt-8">
                <h2 class="text-center text-lg font-semibold text-gray-900 sm:text-2xl" id="radar-header-title">ç»´åº¦å¾—åˆ†åˆ†å¸ƒ</h2>
                <div class="mt-5 rounded-2xl border border-gray-200 bg-white p-4 shadow-sm sm:p-6">
                    <div class="mx-auto max-w-3xl">
                        <canvas id="dimensionRadarChart"></canvas>
                    </div>
                    <div class="mt-6 grid gap-3 sm:grid-cols-2 lg:grid-cols-3" id="dimension-legend">
                        <!-- å›¾ä¾‹å°†åœ¨è¿™é‡Œæ˜¾ç¤º -->
                    </div>
                </div>
            </section>

            <!-- ç»´åº¦åˆ†æ -->
            <section class="mt-8">
                <h2 class="text-center text-lg font-semibold text-gray-900 sm:text-2xl" id="analysis-header-title">è¯¦ç»†åˆ†ææŠ¥å‘Š</h2>
                <div class="mt-5 rounded-2xl border border-gray-200 bg-white p-5 text-gray-700 shadow-sm" id="analysis-content">
                    <!-- åˆ†æå†…å®¹å°†åœ¨è¿™é‡Œæ˜¾ç¤º -->
                </div>
            </section>

            <!-- å»ºè®®å’ŒæŒ‡å¯¼ -->
            <section class="mt-8" id="suggestions-section">
                <h2 class="text-center text-lg font-semibold text-gray-900 sm:text-2xl" id="suggestions-header-title">å»ºè®®å’ŒæŒ‡å¯¼</h2>
                <div class="mt-5 rounded-2xl border border-gray-200 bg-white p-5 text-gray-700 shadow-sm" id="suggestions-content">
                    <!-- å»ºè®®å†…å®¹å°†åœ¨è¿™é‡Œæ˜¾ç¤º -->
                </div>
            </section>

            <!-- Google AdSense ä¸­é—´å¹¿å‘Š -->
            <div class="mx-auto my-10 max-w-3xl text-center">
                <ins class="adsbygoogle block"
                     data-ad-layout="in-article"
                     data-ad-format="fluid"
                     data-ad-client="ca-pub-9195262048954682"
                     data-ad-slot="5294962935"></ins>
                <script>
                (adsbygoogle = window.adsbygoogle || []).push({});
                </script>
            </div>

            <!-- ç›¸å…³æµ‹è¯•æ¨è - SEOå’Œç”¨æˆ·ä½“éªŒä¼˜åŒ– -->
            <section class="related-tests-section mt-10">
                <h2 class="flex items-center justify-center gap-2 text-lg font-semibold text-gray-900 sm:text-2xl">
                    <i class="fas fa-tasks" aria-hidden="true"></i>
                    <span id="related-tests-title">ç›¸å…³å¿ƒç†æµ‹è¯•æ¨è</span>
                </h2>
                <div class="mt-5 grid gap-4 sm:grid-cols-2 lg:grid-cols-3" id="related-tests-content">
                    <!-- ç›¸å…³æµ‹è¯•å°†åœ¨è¿™é‡Œæ˜¾ç¤º -->
                </div>
            </section>

            <!-- çƒ­é—¨æ–‡ç« æ¨è -->
            <section class="popular-articles-section mt-10">
                <h2 class="flex items-center justify-center gap-2 text-lg font-semibold text-gray-900 sm:text-2xl">
                    <i class="fas fa-fire" aria-hidden="true"></i>
                    <span id="popular-articles-title">çƒ­é—¨å¿ƒç†å­¦æ–‡ç« </span>
                </h2>
                <div class="mt-5 grid gap-4 sm:grid-cols-2 lg:grid-cols-3" id="popular-articles-content">
                    <!-- çƒ­é—¨æ–‡ç« å°†åœ¨è¿™é‡Œæ˜¾ç¤º -->
                </div>
            </section>
        </div>
    </div>
</article>

<script type="text/plain">
/* æ·±è‰²é¡¶éƒ¨åŒºåŸŸ */
.top-dark-bar {
    background: #2c3e50;
    color: #ecf0f1;
    padding: 8px 0;
    font-size: 13px;
}

.top-bar-content {
    display: flex;
    justify-content: center;
    align-items: center;
}

.top-bar-text {
    color: #ecf0f1;
    opacity: 0.9;
}

/* é¢åŒ…å±‘å¯¼èˆª - SEOä¼˜åŒ– */
.breadcrumb-nav {
    margin-bottom: 15px;
    background: #fff;
    padding: 12px 15px;
    border-radius: 6px;
    box-shadow: 0 1px 3px rgba(0,0,0,0.05);
}

.breadcrumb {
    background: transparent;
    padding: 0;
    margin: 0;
    font-size: 13px;
    display: flex;
    flex-wrap: wrap;
    list-style: none;
    border: none;
}

.breadcrumb-item {
    display: inline-flex;
    align-items: center;
}

.breadcrumb-item + .breadcrumb-item::before {
    content: "â€º";
    padding: 0 8px;
    color: #adb5bd;
}

.breadcrumb-item a {
    color: #6c757d;
    text-decoration: none;
    transition: color 0.2s;
}

.breadcrumb-item a:hover {
    color: #5DBE9E;
}

.breadcrumb-item.active {
    color: #2c3e50;
    font-weight: 500;
}

/* è°·æ­Œå¹¿å‘Šä½æ ·å¼ */
.ad-container {
    margin: 30px auto;
    max-width: 900px;
    text-align: center;
    min-height: 90px;
}

.ad-banner-top {
    margin: 20px auto 30px;
}

.ad-banner-middle {
    margin: 40px auto;
}

.ad-banner-bottom {
    margin: 40px auto 20px;
}

.ad-container ins {
    display: block;
}

/* æ•´ä½“å®¹å™¨ */
.test-result-page {
    background: #f8f9fa;
    min-height: 100vh;
}

.test-result {
    max-width: 900px;
    margin: 0 auto 20px;
    padding: 20px;
    background: #fff;
    border-radius: 8px;
    border: 1px solid #e8ebed;
}

/* æµ‹è¯•æ ‡é¢˜ */
.test-header {
    text-align: center;
    margin-bottom: 30px;
    padding: 25px 20px;
    background: linear-gradient(135deg, #5DBE9E 0%, #4A9D82 100%);
    border-radius: 10px;
    box-shadow: 0 2px 12px rgba(93, 190, 158, 0.2);
}

.test-header .header-icon {
    font-size: 2.5rem;
    margin-bottom: 10px;
}

@keyframes pulse {
    0%, 100% { transform: scale(1); }
    50% { transform: scale(1.1); }
}

.test-header h1 {
    color: white;
    font-size: 1.8rem;
    font-weight: 600;
    margin: 0 0 10px 0;
}

.test-header .subtitle-text {
    font-size: 1rem;
    color: white;
    font-weight: 400;
    margin: 0;
    opacity: 0.95;
    line-height: 1.6;
}

/* åˆ†æ•°æ˜¾ç¤ºåŒºåŸŸ */
.score-section {
    margin-bottom: 40px;
}

.score-card {
    background: linear-gradient(135deg, #5DBE9E 0%, #4A9D82 100%);
    border-radius: 10px;
    padding: 35px 40px;
    color: white;
    box-shadow: 0 8px 30px rgba(102, 126, 234, 0.3);
}

.score-info-full {
    width: 100%;
    text-align: center;
}

.score-description {
    font-size: 1.3rem;
    font-weight: 600;
    margin-bottom: 15px;
    line-height: 1.4;
}

.score-level {
    font-size: 1.1rem;
    opacity: 0.9;
    padding: 8px 16px;
    background: rgba(255, 255, 255, 0.2);
    border-radius: 20px;
    display: inline-block;
    backdrop-filter: blur(10px);
}

/* é›·è¾¾å›¾åŒºåŸŸ */
.radar-section {
    background: white;
    border-radius: 16px;
    padding: 40px;
    margin-bottom: 30px;
    box-shadow: 0 4px 20px rgba(0,0,0,0.08);
}

.radar-section h2 {
    color: #2c3e50;
    font-size: 1.5rem;
    font-weight: 700;
    margin-bottom: 30px;
    text-align: center;
}

.radar-container {
    max-width: 650px;
    margin: 0 auto;
    position: relative;
    height: 450px;
}

.dimension-legend {
    margin: 30px auto 0;
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
    gap: 15px;
    max-width: 900px;
}

.legend-item {
    display: flex;
    align-items: center;
    gap: 10px;
    padding: 10px 15px;
    background: #f8f9fa;
    border-radius: 8px;
    transition: all 0.2s ease;
    cursor: default;
    justify-content: flex-start;
}

.legend-item:hover {
    background: #e9ecef;
    box-shadow: 0 2px 8px rgba(0,0,0,0.1);
}

.legend-color {
    width: 12px;
    height: 12px;
    border-radius: 50%;
    flex-shrink: 0;
}

.legend-info {
    display: flex;
    flex-direction: column;
    gap: 2px;
    min-width: 0;
    flex: 1;
}

.legend-name {
    font-weight: 600;
    color: #2c3e50;
    font-size: 0.9rem;
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
}

.legend-score {
    font-size: 0.8rem;
    color: #7f8c8d;
    font-weight: 400;
}

/* ç»´åº¦åˆ†æ•°æ˜¾ç¤º */
.dimension-scores-section {
    margin-bottom: 40px;
}

.dimension-scores-section h2 {
    color: #2c3e50;
    font-size: 1.5rem;
    font-weight: 700;
    margin-bottom: 25px;
    text-align: center;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 10px;
}

.dimension-scores-section h2::before {
    content: 'ğŸ“Š';
    font-size: 1.8rem;
}

.dimension-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
    gap: 20px;
    margin-top: 20px;
}

.dimension-item {
    background: #fff;
    padding: 25px;
    border-radius: 12px;
    text-align: center;
    box-shadow: 0 4px 15px rgba(0,0,0,0.1);
    border-left: 5px solid #5DBE9E;
    transition: all 0.3s ease;
    position: relative;
}

.dimension-item:hover {
    transform: translateY(-5px);
    box-shadow: 0 8px 25px rgba(0,0,0,0.15);
}

.rank-badge {
    position: absolute;
    top: 10px;
    right: 10px;
    padding: 5px 12px;
    border-radius: 20px;
    font-size: 0.85rem;
    font-weight: 700;
    color: white;
}

.rank-badge.rank-1 {
    background: linear-gradient(135deg, #ffd700, #ffed4e);
    color: #856404;
}

.rank-badge.rank-2 {
    background: linear-gradient(135deg, #c0c0c0, #e8e8e8);
    color: #495057;
}

.rank-badge.rank-3 {
    background: linear-gradient(135deg, #cd7f32, #daa520);
    color: #fff;
}

.dimension-key {
    font-size: 2rem;
    font-weight: 800;
    color: #2c3e50;
    margin-bottom: 8px;
    opacity: 0.3;
}

.dimension-label {
    font-weight: 600;
    color: #2c3e50;
    margin-bottom: 15px;
    font-size: 1.15rem;
    line-height: 1.4;
}

.dimension-value {
    font-size: 2.8rem;
    font-weight: 800;
    margin-bottom: 15px;
    line-height: 1;
}

.dimension-value .max-score {
    font-size: 1.2rem;
    color: #7f8c8d;
    font-weight: 500;
    margin-left: 3px;
}

.dimension-bar {
    width: 100%;
    height: 10px;
    background: #ecf0f1;
    border-radius: 5px;
    margin: 15px 0 10px 0;
    overflow: hidden;
    position: relative;
}

.dimension-bar-fill {
    height: 100%;
    border-radius: 5px;
    transition: width 1.5s cubic-bezier(0.4, 0, 0.2, 1);
    position: relative;
    overflow: hidden;
    background: linear-gradient(135deg, #5DBE9E 0%, #4A9D82 100%);
}

.dimension-bar-fill::after {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    bottom: 0;
    right: 0;
    background: linear-gradient(
        90deg,
        transparent,
        rgba(255, 255, 255, 0.4),
        transparent
    );
    animation: shimmer 2s infinite;
}

@keyframes shimmer {
    0% { transform: translateX(-100%); }
    100% { transform: translateX(100%); }
}

.dimension-percentage {
    font-size: 0.95rem;
    color: #7f8c8d;
    font-weight: 600;
    margin-top: 8px;
}

/* ç»´åº¦åˆ†ææ ·å¼ */
.dimension-analysis-wrapper {
    padding: 10px 0;
}

.dimension-analysis-item {
    margin-bottom: 25px;
    padding: 20px;
    background: #f8f9fa;
    border-radius: 8px;
    border-left: 4px solid #5DBE9E;
}

.dimension-analysis-item:last-child {
    margin-bottom: 0;
}

.analysis-title {
    color: #2c3e50;
    font-size: 1.2rem;
    font-weight: 600;
    margin: 0 0 12px 0;
    display: flex;
    align-items: center;
    gap: 10px;
}

.analysis-text {
    color: #6c757d;
    line-height: 1.8;
    font-size: 0.95rem;
}

.analysis-text p {
    margin-bottom: 10px;
}

.analysis-text div {
    margin-bottom: 10px;
}

.analysis-text strong {
    color: #3498db;
    font-weight: 600;
}

/* æµ‹è¯•ä¿¡æ¯ - æŠ˜å å¼ */
.test-info {
    margin-bottom: 40px;
}

.info-toggle {
    background: linear-gradient(135deg, #5DBE9E 0%, #4A9D82 100%);
    color: white;
    padding: 20px 25px;
    border-radius: 12px;
    cursor: pointer;
    display: flex;
    justify-content: space-between;
    align-items: center;
    transition: all 0.3s ease;
    box-shadow: 0 4px 15px rgba(93, 190, 158, 0.3);
}

.info-toggle:hover {
    transform: translateY(-2px);
    box-shadow: 0 6px 20px rgba(93, 190, 158, 0.4);
}

.info-toggle h2 {
    margin: 0;
    font-size: 1.3rem;
    font-weight: 600;
}

.info-content {
    background: #f8f9fa;
    border-radius: 0 0 12px 12px;
    padding: 25px;
    border-left: 5px solid #5DBE9E;
    border-top: none;
    color: #495057;
    line-height: 1.6;
    max-height: 0;
    overflow: hidden;
    transition: max-height 0.3s ease, padding 0.3s ease;
}

.info-content.expanded {
    max-height: 2000px;
    padding: 25px;
}

.info-content.collapsed {
    max-height: 0;
    padding: 0 25px;
}

/* åˆ†æåŒºåŸŸ */
.analysis-section {
    margin-bottom: 40px;
}

.analysis-section h2 {
    color: #2c3e50;
    font-size: 1.8rem;
    font-weight: 700;
    margin-bottom: 30px;
    text-align: left;
    padding-left: 5px;
}

/* ç»´åº¦å¡ç‰‡æ ·å¼ */
.dimension-item {
    background: white;
    border-radius: 12px;
    margin-bottom: 20px;
    overflow: hidden;
    box-shadow: 0 2px 8px rgba(0,0,0,0.08);
    transition: all 0.3s ease;
}

.dimension-item:hover {
    box-shadow: 0 4px 16px rgba(0,0,0,0.12);
    transform: translateY(-2px);
}

.dim-header {
    background: linear-gradient(135deg, #5DBE9E 0%, #4A9D82 100%);
    padding: 20px 25px;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: space-between;
    transition: all 0.3s ease;
}

.dim-header:hover {
    background: linear-gradient(135deg, #4A9D82 0%, #5DBE9E 100%);
}

.dim-title-content {
    display: flex;
    align-items: center;
    gap: 15px;
    flex: 1;
}

.dim-key {
    background: rgba(255,255,255,0.25);
    color: white;
    padding: 6px 14px;
    border-radius: 8px;
    font-weight: 700;
    font-size: 1.1rem;
    min-width: 45px;
    text-align: center;
    box-shadow: 0 2px 6px rgba(0,0,0,0.15);
}

.dim-name {
    color: white;
    font-size: 1.3rem;
    font-weight: 600;
    flex: 1;
    text-align: left;
}

.dim-score {
    color: #ffd700;
    font-size: 1.2rem;
    font-weight: 700;
    padding: 4px 12px;
    background: rgba(255,215,0,0.2);
    border-radius: 6px;
}

.dim-toggle {
    color: white;
    font-size: 1.1rem;
    transition: transform 0.3s ease;
    margin-left: 15px;
}

.dim-toggle.rotated {
    transform: rotate(-180deg);
}

.dim-body {
    max-height: 0;
    overflow: hidden;
    transition: max-height 0.4s ease, padding 0.4s ease;
    padding: 0 25px;
    background: #f8f9fa;
}

.dim-body.expanded {
    max-height: 2000px;
    padding: 25px;
}

.dim-cover {
    text-align: left;
    margin-bottom: 20px;
}

.dim-cover img {
    max-width: 100%;
    height: auto;
    border-radius: 12px;
    box-shadow: 0 4px 12px rgba(0,0,0,0.1);
}

.dim-content {
    line-height: 1.8;
    color: #495057;
    font-size: 1rem;
    text-align: left;
}

.dim-content h4 {
    color: #2c3e50;
    font-size: 1.1rem;
    font-weight: 600;
    margin: 20px 0 12px 0;
    text-align: left;
}

.dim-content p {
    margin-bottom: 15px;
    color: #6c757d;
    text-align: left;
}

.dim-content ul, .dim-content ol {
    margin: 15px 0;
    padding-left: 25px;
}

.dim-content li {
    margin-bottom: 10px;
    line-height: 1.7;
}

/* å»ºè®®åŒºåŸŸ */
.suggestions-section {
    margin-bottom: 20px;
}

.suggestions-section h2 {
    color: #2c3e50;
    font-size: 1.3rem;
    font-weight: 600;
    margin-bottom: 20px;
    text-align: left;
    padding-left: 5px;
}

.suggestions-content {
    background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
    border-radius: 12px;
    padding: 25px;
    border-left: 5px solid #5DBE9E;
}

.suggestions-content h4 {
    color: #5DBE9E;
    font-size: 1.1rem;
    font-weight: 600;
    margin: 15px 0 10px 0;
}

.suggestions-content p {
    margin-bottom: 12px;
    color: #495057;
    line-height: 1.6;
}

.suggestions-content ul {
    margin: 15px 0;
    padding-left: 20px;
}

.suggestions-content li {
    margin-bottom: 8px;
    color: #495057;
    line-height: 1.5;
}

/* ç›¸å…³æµ‹è¯•æ¨è - SEOä¼˜åŒ– */
.related-tests-section {
    margin: 50px 0 40px;
    padding: 35px;
    background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
    border-radius: 16px;
}

.related-tests-section h2 {
    color: #2c3e50;
    font-size: 1.6rem;
    font-weight: 700;
    margin-bottom: 30px;
    text-align: center;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 12px;
}

.related-tests-section h2 i {
    color: #667eea;
    font-size: 1.8rem;
}

.related-tests-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
    gap: 20px;
    margin-top: 25px;
}

.related-test-card {
    background: white;
    border-radius: 12px;
    overflow: hidden;
    box-shadow: 0 4px 15px rgba(0, 0, 0, 0.08);
    transition: all 0.3s ease;
    cursor: pointer;
    text-decoration: none;
    color: inherit;
    display: flex;
    flex-direction: column;
}

.related-test-card:hover {
    transform: translateY(-5px);
    box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
}

.test-card-image {
    width: 100%;
    height: 160px;
    object-fit: cover;
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
}

.test-card-content {
    padding: 20px;
    flex: 1;
    display: flex;
    flex-direction: column;
}

.test-card-title {
    font-size: 1.1rem;
    font-weight: 600;
    color: #2c3e50;
    margin-bottom: 10px;
    line-height: 1.4;
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
}

.test-card-desc {
    font-size: 0.9rem;
    color: #7f8c8d;
    line-height: 1.6;
    margin-bottom: 15px;
    flex: 1;
    display: -webkit-box;
    -webkit-line-clamp: 3;
    -webkit-box-orient: vertical;
    overflow: hidden;
}

.test-card-meta {
    display: flex;
    justify-content: space-between;
    align-items: center;
    font-size: 0.85rem;
    color: #95a5a6;
    padding-top: 12px;
    border-top: 1px solid #ecf0f1;
}

.test-card-questions {
    display: flex;
    align-items: center;
    gap: 5px;
}

.test-card-btn {
    background: linear-gradient(135deg, #5DBE9E 0%, #4A9D82 100%);
    color: white;
    padding: 6px 16px;
    border-radius: 20px;
    font-size: 0.85rem;
    font-weight: 600;
    transition: all 0.2s;
}

.test-card-btn:hover {
    transform: scale(1.05);
}

/* çƒ­é—¨æ–‡ç« æ¨è - å¢åŠ å†…éƒ¨é“¾æ¥ */
.popular-articles-section {
    margin: 50px 0 40px;
    padding: 35px;
    background: white;
    border-radius: 16px;
    border: 2px solid #f0f0f0;
}

.popular-articles-section h2 {
    color: #2c3e50;
    font-size: 1.6rem;
    font-weight: 700;
    margin-bottom: 30px;
    text-align: center;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 12px;
}

.popular-articles-section h2 i {
    color: #e74c3c;
    font-size: 1.8rem;
}

.popular-articles-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(260px, 1fr));
    gap: 20px;
    margin-top: 25px;
}

.article-card {
    background: #f8f9fa;
    border-radius: 12px;
    overflow: hidden;
    transition: all 0.3s ease;
    cursor: pointer;
    text-decoration: none;
    color: inherit;
    display: flex;
    flex-direction: column;
    border: 1px solid #e9ecef;
}

.article-card:hover {
    transform: translateY(-3px);
    box-shadow: 0 6px 20px rgba(0, 0, 0, 0.1);
    border-color: #5DBE9E;
}

.article-card-image {
    width: 100%;
    height: 140px;
    object-fit: cover;
    background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
}

.article-card-content {
    padding: 18px;
    flex: 1;
}

.article-card-title {
    font-size: 1rem;
    font-weight: 600;
    color: #2c3e50;
    margin-bottom: 10px;
    line-height: 1.4;
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
}

.article-card-excerpt {
    font-size: 0.85rem;
    color: #7f8c8d;
    line-height: 1.5;
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
    margin-bottom: 12px;
}

.article-card-meta {
    display: flex;
    justify-content: space-between;
    font-size: 0.8rem;
    color: #95a5a6;
    padding-top: 10px;
    border-top: 1px solid #dee2e6;
}

.article-card-views {
    display: flex;
    align-items: center;
    gap: 5px;
}

/* å“åº”å¼è®¾è®¡ */
@media (max-width: 768px) {
    .breadcrumb-nav {
        padding: 10px 0;
    }
    
    .breadcrumb {
        font-size: 0.8rem;
    }
    
    .related-tests-section,
    .popular-articles-section {
        padding: 25px 20px;
        margin: 30px 0;
    }
    
    .related-tests-section h2,
    .popular-articles-section h2 {
        font-size: 1.3rem;
    }
    
    .related-tests-grid {
        grid-template-columns: 1fr;
        gap: 15px;
    }
    
    .popular-articles-grid {
        grid-template-columns: 1fr;
        gap: 15px;
    }
    
    .test-result-page {
        padding: 0;
    }
    
    .test-result {
        padding: 15px;
        margin: 10px;
        border-radius: 12px;
    }
    
    .test-header h1 {
        font-size: 1.8rem;
    }
    
    .test-header p {
        font-size: 1rem;
    }
    
    .score-card {
        padding: 25px 20px;
    }
    
    .score-description {
        font-size: 1.1rem;
    }
    
    .score-level {
        font-size: 1rem;
    }
    
    .radar-section {
        padding: 25px;
    }
    
    .radar-container {
        height: 350px;
    }
    
    .dimension-legend {
        grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
        gap: 10px;
    }
    
    .legend-item {
        padding: 8px 12px;
    }
    
    .dim-header {
        padding: 15px 20px;
    }
    
    .dim-title-content {
        gap: 10px;
    }
    
    .dim-key {
        font-size: 1rem;
        padding: 4px 10px;
        min-width: 40px;
    }
    
    .dim-name {
        font-size: 1.1rem;
    }
    
    .dim-score {
        font-size: 1rem;
        padding: 3px 8px;
    }
    
    .dim-body {
        padding: 20px 15px;
    }
    
    .dim-content {
        font-size: 0.95rem;
    }
    
    .suggestions-content {
        padding: 20px;
    }
    
    .info-toggle {
        padding: 15px 20px;
    }
    
    .info-toggle h2 {
        font-size: 1.1rem;
    }
    
    .info-content.expanded {
        padding: 20px;
    }
    
    .analysis-content {
        padding: 20px;
    }
    
    .section-header h3 {
        font-size: 1.1rem;
    }
    
    .dimension-grid {
        grid-template-columns: 1fr;
        gap: 15px;
    }
    
    .dimension-item {
        padding: 20px;
    }
    
    .dimension-value {
        font-size: 2rem;
    }
    
    .ad-container {
        margin: 15px auto;
        padding: 0 10px;
    }
    
    .ad-placeholder {
        padding: 15px;
        min-height: 80px;
    }
}

@media (max-width: 480px) {
    .test-result {
        padding: 12px;
        margin: 5px;
        border-radius: 8px;
    }
    
    .test-header h1 {
        font-size: 1.6rem;
    }
    
    .test-header p {
        font-size: 0.9rem;
    }
    
    .score-card {
        padding: 25px 15px;
    }
    
    .score-circle {
        width: 100px;
        height: 100px;
    }
    
    .score-number {
        font-size: 2rem;
    }
    
    .info-toggle {
        padding: 12px 15px;
    }
    
    .info-toggle h2 {
        font-size: 1rem;
    }
    
    .info-content.expanded {
        padding: 15px;
    }
    
    .analysis-content {
        padding: 15px;
    }
    
    .suggestions-content {
        padding: 15px;
    }
    
    .dimension-item {
        padding: 15px;
    }
    
    .dimension-value {
        font-size: 1.8rem;
    }
    
    .ad-placeholder {
        padding: 10px;
        min-height: 70px;
        font-size: 12px;
    }
}

/* æŠ˜å åŠ¨ç”» */
.collapsible-section {
    margin-bottom: 30px;
}

.section-header {
    background: linear-gradient(135deg, #5DBE9E 0%, #4A9D82 100%);
    color: white;
    padding: 20px 25px;
    border-radius: 12px;
    cursor: pointer;
    display: flex;
    justify-content: space-between;
    align-items: center;
    transition: all 0.3s ease;
    user-select: none;
}

.section-header:hover {
    transform: translateY(-2px);
    box-shadow: 0 6px 20px rgba(102, 126, 234, 0.3);
}

.section-header h3 {
    margin: 0;
    font-size: 1.25rem;
    font-weight: 600;
}

.toggle-icon {
    transition: transform 0.3s ease;
    font-size: 1.2rem;
}

.toggle-icon.expanded {
    transform: rotate(180deg);
}

.section-content {
    background: #f8f9fa;
    border-radius: 0 0 12px 12px;
    padding: 25px;
    border-left: 5px solid #667eea;
    border-top: none;
    color: #495057;
    line-height: 1.7;
    max-height: 0;
    overflow: hidden;
    transition: max-height 0.4s ease, padding 0.4s ease;
}

.section-content.expanded {
    max-height: 5000px;
    padding: 25px;
}

.section-content.collapsed {
    max-height: 0;
    padding: 0 25px;
}

</script>

<script>
document.addEventListener('DOMContentLoaded', function() {
    // è·å–URLå‚æ•°
    const urlParams = new URLSearchParams(window.location.search);
    const answer_id = urlParams.get('answer_id');
    
    if (!answer_id) {
        document.getElementById('analysis-content').innerHTML = '<div class="rounded-2xl border border-red-200 bg-red-50 p-5 text-center text-sm font-medium text-red-700">æœªæ‰¾åˆ°æµ‹è¯•ç»“æœ</div>';
        return;
    }
    
    // è·å–URLå‚æ•°ä¸­çš„è¯­è¨€
    const lg = urlParams.get('lg') || 'zh-cn';
    
    // è·å–æµ‹è¯•ç»“æœ
    fetch('/addons/cms/psychometry/answerInfo', {
        method: 'POST',
        headers: {
            'Content-Type': 'application/x-www-form-urlencoded',
        },
        body: 'answer_id=' + answer_id + '&lang=' + lg
    })
    .then(response => response.json())
    .then(data => {
        if (data.code === 1) {
            displayDimensionResult(data.data);
        } else {
            document.getElementById('analysis-content').innerHTML = '<div class="rounded-2xl border border-red-200 bg-red-50 p-5 text-center text-sm font-medium text-red-700">è·å–ç»“æœå¤±è´¥ï¼š' + data.msg + '</div>';
        }
    })
    .catch(error => {
        console.error('Error:', error);
        document.getElementById('analysis-content').innerHTML = '<div class="rounded-2xl border border-red-200 bg-red-50 p-5 text-center text-sm font-medium text-red-700">ç½‘ç»œé”™è¯¯ï¼Œè¯·ç¨åé‡è¯•</div>';
    });
});

function displayDimensionResult(data) {
    // è·å–è¯­è¨€è®¾ç½®
    const urlParams = new URLSearchParams(window.location.search);
    const lg = urlParams.get('lg') || 'zh-cn';
    const isEnglish = lg === 'en';
    
    // æ›´æ–°æ‰€æœ‰ç•Œé¢æ–‡æœ¬ï¼ˆå¤šè¯­è¨€æ”¯æŒï¼‰
    updateUILanguage(isEnglish, data);
    
    // æ›´æ–°é¡µé¢æ ‡é¢˜
    if (data.a_info) {
        const title = data.a_info.title || (isEnglish ? 'Dimension Test Result' : 'ç»´åº¦æµ‹è¯•ç»“æœ');
        document.getElementById('test-title').textContent = title;
        
        // æ›´æ–°é¡µé¢tabæ ‡é¢˜
        const tabSuffix = isEnglish ? ' - Test Result' : ' - æµ‹è¯•ç»“æœ';
        document.title = title + tabSuffix;
    }
    
    // æ˜¾ç¤ºä¸»å¯¼ç±»å‹æè¿°
    const scoreInfo = getScoreInfo(0, data, isEnglish);
    document.getElementById('score-description').innerHTML = scoreInfo.description;
    document.getElementById('score-level').textContent = scoreInfo.level;
    
    // æ˜¾ç¤ºç»´åº¦åˆ†æ•°
    displayDimensionScores(data);
    
    // æ˜¾ç¤ºåˆ†æå†…å®¹
    displayAnalysis(data);
    
    // æ˜¾ç¤ºæµ‹è¯•ä¿¡æ¯
    displayTestInfo(data, isEnglish);
    
    // æ˜¾ç¤ºå»ºè®®å’ŒæŒ‡å¯¼
    displaySuggestions(data);
    
    // æ·»åŠ åŠ è½½åŠ¨ç”»
    setTimeout(() => {
        document.querySelectorAll('.dimension-bar-fill').forEach((el, index) => {
            setTimeout(() => {
                el.style.width = el.getAttribute('data-width') || el.style.width;
            }, index * 100);
        });
    }, 300);
}

// ç¿»è¯‘ç»´åº¦åç§°ï¼ˆä¸­æ–‡è½¬è‹±æ–‡ï¼‰
function translateDimensionName(chineseName) {
    // å¡ç‰¹å°”16PFç»´åº¦ç¿»è¯‘å¯¹ç…§è¡¨
    const translations = {
        'Aä¹ç¾¤æ€§': 'A-Warmth',
        'Bèªæ…§æ€§': 'B-Reasoning',
        'Cç¨³å®šæ€§': 'C-Emotional Stability',
        'Eæƒå¼ºæ€§': 'E-Dominance',
        'Få…´å¥‹æ€§': 'F-Liveliness',
        'Gæœ‰æ’æ€§': 'G-Rule-Consciousness',
        'Hæ•¢ä¸ºæ€§': 'H-Social Boldness',
        'Iæ•æ„Ÿæ€§': 'I-Sensitivity',
        'Læ€€ç–‘æ€§': 'L-Vigilance',
        'Må¹»æƒ³æ€§': 'M-Abstractedness',
        'Nä¸–æ•…æ€§': 'N-Privateness',
        'Oå¿§è™‘æ€§': 'O-Apprehension',
        'Q1å®éªŒæ€§': 'Q1-Openness to Change',
        'Q2ç‹¬ç«‹æ€§': 'Q2-Self-Reliance',
        'Q3è‡ªå¾‹æ€§': 'Q3-Perfectionism',
        'Q4ç´§å¼ æ€§': 'Q4-Tension',
        // å»æ‰å‰ç¼€çš„ç‰ˆæœ¬
        'ä¹ç¾¤æ€§': 'Warmth',
        'èªæ…§æ€§': 'Reasoning',
        'ç¨³å®šæ€§': 'Emotional Stability',
        'æƒå¼ºæ€§': 'Dominance',
        'å…´å¥‹æ€§': 'Liveliness',
        'æœ‰æ’æ€§': 'Rule-Consciousness',
        'æ•¢ä¸ºæ€§': 'Social Boldness',
        'æ•æ„Ÿæ€§': 'Sensitivity',
        'æ€€ç–‘æ€§': 'Vigilance',
        'å¹»æƒ³æ€§': 'Abstractedness',
        'ä¸–æ•…æ€§': 'Privateness',
        'å¿§è™‘æ€§': 'Apprehension',
        'å®éªŒæ€§': 'Openness to Change',
        'ç‹¬ç«‹æ€§': 'Self-Reliance',
        'è‡ªå¾‹æ€§': 'Perfectionism',
        'ç´§å¼ æ€§': 'Tension',
        // éœå…°å¾·èŒä¸šå…´è¶£æµ‹è¯•
        'Rç°å®å‹': 'R-Realistic',
        'Iç ”ç©¶å‹': 'I-Investigative',
        'Aè‰ºæœ¯å‹': 'A-Artistic',
        'Sç¤¾ä¼šå‹': 'S-Social',
        'Eä¼ä¸šå‹': 'E-Enterprising',
        'Cä¼ ç»Ÿå‹': 'C-Conventional',
        'ç°å®å‹': 'Realistic',
        'ç ”ç©¶å‹': 'Investigative',
        'è‰ºæœ¯å‹': 'Artistic',
        'ç¤¾ä¼šå‹': 'Social',
        'ä¼ä¸šå‹': 'Enterprising',
        'ä¼ ç»Ÿå‹': 'Conventional',
        // MBTIç»´åº¦
        'å¤–å‘': 'Extraversion',
        'å†…å‘': 'Introversion',
        'æ„Ÿè§‰': 'Sensing',
        'ç›´è§‰': 'Intuition',
        'æ€ç»´': 'Thinking',
        'æƒ…æ„Ÿ': 'Feeling',
        'åˆ¤æ–­': 'Judging',
        'çŸ¥è§‰': 'Perceiving'
    };
    
    // å…ˆå°è¯•å®Œå…¨åŒ¹é…
    if (translations[chineseName]) {
        return translations[chineseName];
    }
    
    // å°è¯•å»æ‰å‰ç¼€å­—æ¯ååŒ¹é…
    const withoutPrefix = chineseName.replace(/^[A-Z0-9]+/, '');
    if (translations[withoutPrefix]) {
        // ä¿ç•™åŸæ¥çš„å‰ç¼€
        const prefix = chineseName.match(/^[A-Z0-9]+/);
        return prefix ? `${prefix[0]}-${translations[withoutPrefix]}` : translations[withoutPrefix];
    }
    
    // å¦‚æœæ²¡æœ‰æ‰¾åˆ°ç¿»è¯‘ï¼Œè¿”å›åŸåç§°
    return chineseName;
}

// æ›´æ–°UIè¯­è¨€
function updateUILanguage(isEnglish, data) {
    const texts = {
        zh: {
            testResult: 'æµ‹è¯•ç»“æœ',
            subtitle: 'æ„Ÿè°¢æ‚¨å®Œæˆæµ‹è¯•ï¼Œä»¥ä¸‹æ˜¯æ‚¨çš„è¯¦ç»†åˆ†ææŠ¥å‘Š',
            testInfo: 'æµ‹è¯•ä¿¡æ¯',
            radarChart: 'ç»´åº¦å¾—åˆ†åˆ†å¸ƒ',
            analysisReport: 'è¯¦ç»†åˆ†ææŠ¥å‘Š',
            suggestions: 'å»ºè®®å’ŒæŒ‡å¯¼',
            loading: 'æ­£åœ¨åŠ è½½...',
            analyzing: 'æ­£åœ¨åˆ†ææ‚¨çš„ç»´åº¦ç‰¹ç‚¹...',
            evaluating: 'è¯„ä¼°ä¸­...',
            score: 'åˆ†'
        },
        en: {
            testResult: 'Test Result',
            subtitle: 'Thank you for completing the test. Below is your detailed analysis report',
            testInfo: 'Test Information',
            radarChart: 'Dimension Score Distribution',
            analysisReport: 'Detailed Analysis Report',
            suggestions: 'Suggestions',
            loading: 'Loading...',
            analyzing: 'Analyzing your dimension characteristics...',
            evaluating: 'Evaluating...',
            score: ''  // è‹±æ–‡ç‰ˆä¸æ˜¾ç¤ºå•ä½ï¼Œæ›´ç®€æ´
        }
    };
    
    const t = isEnglish ? texts.en : texts.zh;
    
    // æ›´æ–°é¡µé¢æ ‡é¢˜å’Œå‰¯æ ‡é¢˜ï¼ˆå¦‚æœæ²¡æœ‰ä»dataä¸­è·å–ï¼‰
    const titleElement = document.getElementById('test-title');
    if (!data.a_info?.title) {
        titleElement.textContent = t.testResult;
    }
    
    const subtitleElement = document.getElementById('test-subtitle');
    subtitleElement.textContent = t.subtitle;
    
    // æ›´æ–°å„ä¸ªåŒºåŸŸæ ‡é¢˜
    document.getElementById('info-header-title').textContent = t.testInfo;
    document.getElementById('radar-header-title').textContent = t.radarChart;
    document.getElementById('analysis-header-title').textContent = t.analysisReport;
    document.getElementById('suggestions-header-title').textContent = t.suggestions;
    
    // ä¿å­˜æ–‡æœ¬åˆ°å…¨å±€å˜é‡ï¼Œä¾›å…¶ä»–å‡½æ•°ä½¿ç”¨
    window.i18nTexts = t;
}

function getScoreInfo(score, data, isEnglish) {
    // ä¼˜å…ˆä½¿ç”¨analyse.dimensionsä¸­çš„é…ç½®ä¿¡æ¯
    if (data.analyse && data.analyse.dimensions) {
        const dimensionArray = Object.values(data.analyse.dimensions)
            .sort((a, b) => b.score - a.score)
            .slice(0, 3);
        
        if (dimensionArray.length > 0) {
            const separator = isEnglish ? ', ' : 'ã€';
            const topNames = dimensionArray.map(dim => {
                // ä¼˜å…ˆä½¿ç”¨ titleï¼ˆå®Œæ•´åç§°ï¼‰ï¼Œå…¶æ¬¡ nameï¼Œæœ€å key
                let displayName = dim.title || dim.name || dim.key;
                
                // å¦‚æœæ˜¯è‹±æ–‡ç‰ˆä¸”åç§°åŒ…å«ä¸­æ–‡ï¼Œè¿›è¡Œç¿»è¯‘
                if (isEnglish && /[\u4e00-\u9fa5]/.test(displayName)) {
                    displayName = translateDimensionName(displayName);
                }
                
                return `${displayName} (${dim.score}${isEnglish ? ' pts' : 'åˆ†'})`;
            }).join(separator);
            
            return {
                level: isEnglish ? 'Dominant Types' : 'ä¸»å¯¼ç±»å‹',
                description: isEnglish 
                    ? `Your dominant types are: ${topNames}`
                    : `æ‚¨çš„ä¸»å¯¼ç±»å‹æ˜¯ï¼š${topNames}`
            };
        }
    }
    
    // å…¼å®¹æ—§æ ¼å¼ï¼šä»stat_dataè·å–
    const dimensions = data.stat_data || {};
    let topDimensions = Object.entries(dimensions)
        .filter(([key]) => key !== 'æ€»åˆ†')
        .sort((a, b) => b[1] - a[1])
        .slice(0, 3);
    
    if (topDimensions.length > 0) {
        const separator = isEnglish ? ', ' : 'ã€';
        const topNames = topDimensions.map(([key, score]) => {
            let displayName = key;
            
            // å¦‚æœæ˜¯è‹±æ–‡ç‰ˆä¸”åç§°åŒ…å«ä¸­æ–‡ï¼Œè¿›è¡Œç¿»è¯‘
            if (isEnglish && /[\u4e00-\u9fa5]/.test(displayName)) {
                displayName = translateDimensionName(displayName);
            }
            
            return `${displayName} (${score}${isEnglish ? ' pts' : 'åˆ†'})`;
        }).join(separator);
        
        return {
            level: isEnglish ? 'Dominant Types' : 'ä¸»å¯¼ç±»å‹',
            description: isEnglish 
                ? `Your dominant types are: ${topNames}`
                : `æ‚¨çš„ä¸»å¯¼ç±»å‹æ˜¯ï¼š${topNames}`
        };
    }
    
    // å¦‚æœæœ‰analyseæ•°æ®ï¼Œä½¿ç”¨å®ƒ
    if (data.analyse && data.analyse.title) {
        return {
            level: data.analyse.title,
            description: data.analyse.intro || (isEnglish 
                ? 'Based on your test results, we have analyzed your performance in each dimension'
                : 'æ ¹æ®æ‚¨çš„æµ‹è¯•ç»“æœï¼Œæˆ‘ä»¬ä¸ºæ‚¨åˆ†æäº†å„ä¸ªç»´åº¦çš„è¡¨ç°')
        };
    }
    
    return {
        level: isEnglish ? 'Test Completed' : 'æµ‹è¯•å®Œæˆ',
        description: isEnglish 
            ? 'Thank you for completing the test. Please see the detailed analysis below'
            : 'æ„Ÿè°¢æ‚¨å®Œæˆæµ‹è¯•ï¼Œè¯·æŸ¥çœ‹ä¸‹æ–¹è¯¦ç»†åˆ†æ'
    };
}

function displayDimensionScores(data) {
    // ä¼˜å…ˆä½¿ç”¨analyse.dimensionsä¸­çš„é…ç½®ä¿¡æ¯
    let dimensionArray = [];
    
    if (data.analyse && data.analyse.dimensions) {
        // ä½¿ç”¨åç«¯è¿”å›çš„å®Œæ•´ç»´åº¦é…ç½®
        dimensionArray = Object.values(data.analyse.dimensions)
            .sort((a, b) => b.score - a.score);
    } else {
        // å…¼å®¹æ—§æ ¼å¼ï¼šä»stat_dataæ„å»º
        const dimensions = data.stat_data || {};
        
        if (Object.keys(dimensions).length === 0 || (Object.keys(dimensions).length <= 1 && dimensions['æ€»åˆ†'])) {
            return;
        }
        
        dimensionArray = Object.entries(dimensions)
            .filter(([key]) => key !== 'æ€»åˆ†')
            // è¿‡æ»¤å¯¹ç«‹ç»´åº¦ï¼šå¦‚æœåŒæ—¶å­˜åœ¨"XXç¨³å®šæ€§"å’Œ"XXä¸ç¨³å®šæ€§"ï¼Œåªä¿ç•™åˆ†æ•°è¾ƒé«˜çš„é‚£ä¸ª
            .filter(([key, score], index, arr) => {
                // æ£€æŸ¥æ˜¯å¦æ˜¯"ä¸ç¨³å®šæ€§"ç»´åº¦
                if (key.includes('ä¸ç¨³å®šæ€§')) {
                    const stableKey = key.replace('ä¸ç¨³å®šæ€§', 'ç¨³å®šæ€§');
                    const stableEntry = arr.find(([k]) => k === stableKey);
                    // å¦‚æœå­˜åœ¨å¯¹åº”çš„"ç¨³å®šæ€§"ç»´åº¦ï¼Œæ¯”è¾ƒåˆ†æ•°ï¼Œåªä¿ç•™åˆ†æ•°é«˜çš„
                    if (stableEntry) {
                        return score > stableEntry[1];
                    }
                }
                // æ£€æŸ¥æ˜¯å¦æ˜¯"ç¨³å®šæ€§"ç»´åº¦
                if (key.includes('ç¨³å®šæ€§') && !key.includes('ä¸ç¨³å®šæ€§')) {
                    const unstableKey = key.replace('ç¨³å®šæ€§', 'ä¸ç¨³å®šæ€§');
                    const unstableEntry = arr.find(([k]) => k === unstableKey);
                    // å¦‚æœå­˜åœ¨å¯¹åº”çš„"ä¸ç¨³å®šæ€§"ç»´åº¦ï¼Œæ¯”è¾ƒåˆ†æ•°ï¼Œåªä¿ç•™åˆ†æ•°é«˜çš„
                    if (unstableEntry) {
                        return score > unstableEntry[1];
                    }
                }
                return true; // å…¶ä»–ç»´åº¦éƒ½ä¿ç•™
            })
            .map(([key, score]) => ({
                key: key,
                name: key,
                score: score,
                max_score: 15 // é»˜è®¤æ»¡åˆ†
            }))
            .sort((a, b) => b.score - a.score);
    }
    
    if (dimensionArray.length === 0) {
        return;
    }
    
    // åªæœ‰ç»´åº¦æ•°é‡>=3æ—¶æ‰æ˜¾ç¤ºé›·è¾¾å›¾ï¼Œå¦åˆ™éšè—é›·è¾¾å›¾åŒºåŸŸ
    const radarSection = document.querySelector('.radar-section');
    if (dimensionArray.length >= 3) {
        // åˆ›å»ºé›·è¾¾å›¾å’Œå›¾ä¾‹
        createRadarChart(dimensionArray);
        createLegend(dimensionArray);
        if (radarSection) {
            radarSection.classList.remove('hidden');
        }
    } else {
        // ç»´åº¦æ•°é‡å°‘äº3ï¼Œéšè—é›·è¾¾å›¾åŒºåŸŸ
        if (radarSection) {
            radarSection.classList.add('hidden');
        }
        console.log('ç»´åº¦æ•°é‡å°‘äº3ä¸ªï¼Œä¸é€‚åˆæ˜¾ç¤ºé›·è¾¾å›¾');
    }
}

// åˆ›å»ºå›¾ä¾‹
function createLegend(dimensionArray) {
    const legendContainer = document.getElementById('dimension-legend');
    if (!legendContainer) return;
    
    // é¢„å®šä¹‰é¢œè‰²æ–¹æ¡ˆ
    const colorPalette = [
        '#3498db', '#9b59b6', '#e74c3c', 
        '#2ecc71', '#f39c12', '#1abc9c',
        '#e67e22', '#16a085', '#c0392b'
    ];
    
    // è·å–å½“å‰è¯­è¨€è®¾ç½®
    const urlParams = new URLSearchParams(window.location.search);
    const lg = urlParams.get('lg') || 'zh-cn';
    const isEnglish = lg === 'en';
    
    // è·å–å½“å‰è¯­è¨€çš„åˆ†æ•°å•ä½
    const scoreUnit = window.i18nTexts?.score || 'åˆ†';
    
    let html = '';
    dimensionArray.forEach((dim, index) => {
        const color = colorPalette[index % colorPalette.length];
        // ä¸»å¯¼æ ‡è®°ï¼šå‰3åæ˜¾ç¤ºæ’åï¼Œè¡¨ç¤ºä¸»å¯¼ç±»å‹
        const rankBadge = index < 3 ? `<span class="mr-1 font-semibold" data-color="${color}">#${index + 1}</span>` : '';
        // ä¼˜å…ˆä½¿ç”¨ titleï¼ˆå®Œæ•´åç§°ï¼‰ï¼Œå…¶æ¬¡ nameï¼Œæœ€å key
        let displayName = dim.title || dim.name || dim.key;
        
        // å¦‚æœæ˜¯è‹±æ–‡ç‰ˆä¸”åç§°åŒ…å«ä¸­æ–‡ï¼Œè¿›è¡Œç¿»è¯‘
        if (isEnglish && /[\u4e00-\u9fa5]/.test(displayName)) {
            displayName = translateDimensionName(displayName);
        }
        
        html += `
            <div class="flex items-center gap-3 rounded-xl border border-gray-200 bg-white px-4 py-3 shadow-sm">
                <span class="h-3 w-3 rounded-full" data-color="${color}"></span>
                <div class="min-w-0">
                    <div class="truncate text-sm font-semibold text-gray-900">${rankBadge}${displayName}</div>
                    <div class="mt-0.5 text-xs font-medium text-gray-500">${dim.score}${scoreUnit}</div>
                </div>
            </div>
        `;
    });
    
    legendContainer.innerHTML = html;
    legendContainer.querySelectorAll('[data-color]').forEach(el => {
        el.style.color = el.dataset.color;
        if (el.classList.contains('h-3')) {
            el.style.backgroundColor = el.dataset.color;
        }
    });
}

function displayTestInfo(data, isEnglish) {
    let infoHtml = '';
    
    if (data.a_info) {
        const labels = isEnglish ? {
            testName: 'Test Name: ',
            description: 'Description: ',
            questionCount: 'Questions: ',
            maxScore: 'Max Score: ',
            testType: 'Test Type: ',
            questions: ' questions',
            points: ' points',
            dimensionTest: 'Dimension Test'
        } : {
            testName: 'æµ‹è¯•åç§°ï¼š',
            description: 'æµ‹è¯•è¯´æ˜ï¼š',
            questionCount: 'é¢˜ç›®æ•°é‡ï¼š',
            maxScore: 'æ»¡åˆ†ï¼š',
            testType: 'æµ‹è¯•ç±»å‹ï¼š',
            questions: ' é¢˜',
            points: ' åˆ†',
            dimensionTest: 'ç»´åº¦æµ‹è¯•'
        };
        
        const testTitle = data.a_info.title || (isEnglish ? 'Dimension Test' : 'ç»´åº¦æµ‹è¯•');

        // ä¼˜å…ˆä½¿ç”¨sub_titleï¼Œå¦‚æœæ²¡æœ‰åˆ™ä½¿ç”¨description
        let description = data.a_info.sub_title || data.a_info.description || '';
        if (!description) {
            description = isEnglish ? '-' : 'æš‚æ— è¯´æ˜';
        }

        const questionCount = data.test_info?.question_count || 0;
        const maxScore = data.analyse?.max_possible_score || data.test_info?.question_count || 15;

        infoHtml += '<div class="divide-y divide-gray-200 overflow-hidden rounded-xl border border-gray-200 bg-white">';
        infoHtml += '<div class="flex items-center justify-between gap-4 px-4 py-3 text-sm"><span class="font-semibold text-gray-700">' + labels.testName.replace(/[:ï¼š]\s*$/, '') + '</span><span class="text-gray-600">' + testTitle + '</span></div>';
        infoHtml += '<div class="flex items-center justify-between gap-4 px-4 py-3 text-sm"><span class="font-semibold text-gray-700">' + labels.description.replace(/[:ï¼š]\s*$/, '') + '</span><span class="text-gray-600">' + description + '</span></div>';
        infoHtml += '<div class="flex items-center justify-between gap-4 px-4 py-3 text-sm"><span class="font-semibold text-gray-700">' + labels.questionCount.replace(/[:ï¼š]\s*$/, '') + '</span><span class="text-gray-600">' + questionCount + labels.questions + '</span></div>';
        infoHtml += '<div class="flex items-center justify-between gap-4 px-4 py-3 text-sm"><span class="font-semibold text-gray-700">' + labels.maxScore.replace(/[:ï¼š]\s*$/, '') + '</span><span class="text-gray-600">' + maxScore + labels.points + '</span></div>';
        infoHtml += '<div class="flex items-center justify-between gap-4 px-4 py-3 text-sm"><span class="font-semibold text-gray-700">' + labels.testType.replace(/[:ï¼š]\s*$/, '') + '</span><span class="text-gray-600">' + labels.dimensionTest + '</span></div>';
        infoHtml += '</div>';
    }
    
    document.getElementById('info-content').innerHTML = infoHtml;
}

function displayAnalysis(data) {
    let analysisHtml = '';
    
    // ä¼˜å…ˆä½¿ç”¨ dimensions å¯¹è±¡ï¼ŒæŒ‰ç…§ç»´åº¦ç»“æ„æ˜¾ç¤º
    if (data.analyse && data.analyse.dimensions) {
        const dimensions = data.analyse.dimensions;
        let hasDimensions = false;
        
        // åŠ¨æ€æŒ‰åˆ†æ•°ä»é«˜åˆ°ä½æ’åºï¼ˆä¸ç¡¬ç¼–ç ç»´åº¦é¡ºåºï¼‰
        const sortedDimensions = Object.entries(dimensions)
            .sort((a, b) => b[1].score - a[1].score)
            .map(([key, dim]) => ({ key, ...dim }));
        
        // åˆ¤æ–­æ˜¯å¦ä¸ºè‹±æ–‡ç‰ˆ
        const urlParams = new URLSearchParams(window.location.search);
        const lg = urlParams.get('lg') || 'zh-cn';
        const isEnglish = lg === 'en';
        
        sortedDimensions.forEach((dim, index) => {
            if (dim.name && dim.score !== undefined) {
                hasDimensions = true;
                
                // æå–åˆ†æå†…å®¹ - ä¼˜å…ˆä½¿ç”¨ analysisï¼Œå…¶æ¬¡ contentï¼Œå†æ¬¡ intro
                const analysisContent = dim.analysis || dim.content || dim.intro || '';
                
                // æå–å›¾ç‰‡ï¼ˆå¦‚æœæœ‰ï¼‰
                const coverImage = dim.cover ? `
                    <div class="mb-4 overflow-hidden rounded-xl border border-gray-200 bg-white shadow-sm">
                        <img src="${dim.cover}" alt="${dim.name}" class="h-auto w-full" loading="lazy">
                    </div>
                ` : '';
                
                // æ ‡é¢˜æ–‡æœ¬ï¼šå¦‚æœ title å­˜åœ¨åˆ™ä½¿ç”¨ï¼Œå¦åˆ™ä½¿ç”¨ name
                let displayTitle = dim.title || dim.name || dim.key;
                
                // å¦‚æœæ˜¯è‹±æ–‡ç‰ˆä¸”æ ‡é¢˜åŒ…å«ä¸­æ–‡ï¼Œè¿›è¡Œç¿»è¯‘
                if (isEnglish && /[\u4e00-\u9fa5]/.test(displayTitle)) {
                    displayTitle = translateDimensionName(displayTitle);
                }
                
                // è·å–å½“å‰è¯­è¨€çš„åˆ†æ•°å•ä½
                const scoreUnit = window.i18nTexts?.score || 'åˆ†';
                
                analysisHtml += `
                    <div class="overflow-hidden rounded-2xl border border-gray-200 bg-white shadow-sm">
                        <button type="button" class="flex w-full items-center justify-between gap-4 bg-gradient-to-br from-emerald-500 to-emerald-700 px-5 py-4 text-left text-white" onclick="toggleDimensionContent(this)">
                            <div class="flex min-w-0 items-center gap-3">
                                <span class="inline-flex h-8 w-8 items-center justify-center rounded-lg bg-white/20 text-sm font-bold">${dim.key}</span>
                                <span class="truncate text-base font-semibold">${displayTitle}</span>
                                <span class="ml-2 inline-flex shrink-0 items-center rounded-full bg-white/20 px-2 py-0.5 text-xs font-semibold">${dim.score}${scoreUnit}</span>
                            </div>
                            <i class="fas fa-chevron-down dim-toggle transition-transform"></i>
                        </button>
                        <div class="dim-body hidden bg-gray-50 px-5 py-5">
                            ${coverImage}
                            <div class="prose prose-sm max-w-none text-gray-700">${analysisContent}</div>
                        </div>
                    </div>
                `;
            }
        });
        
        if (hasDimensions) {
            document.getElementById('analysis-content').innerHTML = analysisHtml;
            return;
        }
    }
    
    // é™çº§ï¼šå¦‚æœæ²¡æœ‰ dimensions ç»“æ„ï¼Œæ˜¾ç¤ºæç¤º
    analysisHtml = `
        <div class="rounded-2xl border border-gray-200 bg-gray-50 p-8 text-center text-gray-600">
            <div class="mx-auto mb-4 flex h-12 w-12 items-center justify-center rounded-full bg-white text-gray-400 shadow-sm">
                <i class="fas fa-chart-bar" aria-hidden="true"></i>
            </div>
            <p class="text-sm font-semibold text-gray-700">è¯¦ç»†åˆ†æå†…å®¹æ­£åœ¨å‡†å¤‡ä¸­...</p>
            <p class="mt-2 text-sm">è¯·å‚è€ƒä¸Šæ–¹é›·è¾¾å›¾å’Œå›¾ä¾‹äº†è§£æ‚¨çš„å„ç»´åº¦å¾—åˆ†</p>
        </div>
    `;
    
    document.getElementById('analysis-content').innerHTML = analysisHtml;
}

function displaySuggestions(data) {
    let suggestionsHtml = '';
    
    // å¦‚æœæœ‰analyseæ•°æ®ä¸­çš„å»ºè®®ï¼Œä¼˜å…ˆæ˜¾ç¤º
    if (data.analyse && data.analyse.suggestion) {
        suggestionsHtml = data.analyse.suggestion;
    } else {
        // è·å–å½“å‰è¯­è¨€ï¼Œåˆ¤æ–­æ˜¯å¦ä¸ºè‹±æ–‡
        const lg = new URLSearchParams(window.location.search).get('lg');
        const isEnglish = lg === 'en';
        
        // æ˜¾ç¤ºé€šç”¨å»ºè®®ï¼ˆå¤šè¯­è¨€ï¼‰
        if (isEnglish) {
            suggestionsHtml = `
                <h4>ğŸ’¡ General Suggestions</h4>
                <ul>
                    <li>Understand your current status based on test results</li>
                    <li>Consult relevant professionals if you have any questions</li>
                    <li>Maintain a positive mindset and continue to focus on personal development</li>
                    <li>Conduct regular self-assessment and reflection</li>
                </ul>
                
                <h4>ğŸ“ Notes</h4>
                <p>Test results are for reference only. Please consult a professional for specific guidance.</p>
            `;
        } else {
            suggestionsHtml = `
                <h4>ğŸ’¡ é€šç”¨å»ºè®®</h4>
                <ul>
                    <li>æ ¹æ®æµ‹è¯•ç»“æœï¼Œäº†è§£è‡ªå·±çš„ç°çŠ¶</li>
                    <li>å¦‚æœ‰ç–‘é—®ï¼Œå»ºè®®å’¨è¯¢ç›¸å…³ä¸“ä¸šäººå£«</li>
                    <li>ä¿æŒç§¯æçš„å¿ƒæ€ï¼ŒæŒç»­å…³æ³¨è‡ªèº«å‘å±•</li>
                    <li>å®šæœŸè¿›è¡Œè‡ªæˆ‘è¯„ä¼°å’Œåæ€</li>
                </ul>
                
                <h4>ğŸ“ æ³¨æ„äº‹é¡¹</h4>
                <p>æµ‹è¯•ç»“æœä»…ä¾›å‚è€ƒï¼Œå…·ä½“è¯·å’¨è¯¢ä¸“ä¸šæŒ‡å¯¼ã€‚</p>
            `;
        }
    }
    
    document.getElementById('suggestions-content').innerHTML = suggestionsHtml;
    
    // åŠ è½½ç›¸å…³æ¨èå†…å®¹
    loadRelatedTests();
    loadPopularArticles();
}

// åŠ è½½ç›¸å…³æµ‹è¯•
function loadRelatedTests() {
    const lg = new URLSearchParams(window.location.search).get('lg') || 'zh-cn';
    const isEnglish = lg === 'en';
    
    // æ›´æ–°æ ‡é¢˜
    document.getElementById('related-tests-title').textContent = isEnglish ? 'Related Psychological Tests' : 'ç›¸å…³å¿ƒç†æµ‹è¯•æ¨è';
    
    // è·å–ç›¸å…³æµ‹è¯•ï¼ˆè¿™é‡Œä½¿ç”¨æ¨¡æ‹Ÿæ•°æ®ï¼Œå®é™…åº”è¯¥è°ƒç”¨åç«¯APIï¼‰
    fetch('/addons/cms/psychometry/getRelatedTests?limit=6&lang=' + lg)
        .then(response => response.json())
        .then(data => {
            if (data.code === 1 && data.data && data.data.length > 0) {
                displayRelatedTests(data.data, isEnglish);
            } else {
                // å¦‚æœAPIä¸å­˜åœ¨æˆ–æ²¡æœ‰æ•°æ®ï¼Œéšè—è¯¥åŒºåŸŸ
                document.querySelector('.related-tests-section')?.classList.add('hidden');
            }
        })
        .catch(error => {
            console.log('åŠ è½½ç›¸å…³æµ‹è¯•:', error);
            // APIä¸å­˜åœ¨æ—¶éšè—è¯¥åŒºåŸŸ
            document.querySelector('.related-tests-section')?.classList.add('hidden');
        });
}

// æ˜¾ç¤ºç›¸å…³æµ‹è¯•
function displayRelatedTests(tests, isEnglish) {
    const container = document.getElementById('related-tests-content');
    let html = '';
    
    tests.forEach(test => {
        const title = test.title || '';
        const description = test.description || test.intro || '';
        const questionCount = test.question_count || 0;
        const url = test.url || `/test/${test.id}`;
        const imageUrl = test.image || test.cover || '';
        
        html += `
            <a href="${url}" class="group overflow-hidden rounded-2xl border border-gray-200 bg-white shadow-sm transition hover:-translate-y-0.5 hover:shadow-md" title="${title}">
                <div class="aspect-[16/9] bg-gradient-to-br from-indigo-500 to-purple-600">
                    ${imageUrl ? `<img src="${imageUrl}" alt="${title}" class="h-full w-full object-cover" loading="lazy">` : ''}
                </div>
                <div class="p-4">
                    <h3 class="text-sm font-semibold text-gray-900">${title}</h3>
                    <p class="mt-2 text-sm text-gray-600">${description}</p>
                    <div class="mt-4 flex items-center justify-between text-xs text-gray-500">
                        <span class="inline-flex items-center gap-1">
                            <i class="fas fa-question-circle" aria-hidden="true"></i>
                            ${questionCount} ${isEnglish ? 'questions' : 'é¢˜'}
                        </span>
                        <span class="inline-flex items-center rounded-full bg-emerald-600 px-3 py-1 text-xs font-semibold text-white">${isEnglish ? 'Take Test' : 'å¼€å§‹æµ‹è¯•'}</span>
                    </div>
                </div>
            </a>
        `;
    });
    
    container.innerHTML = html;
}

// åŠ è½½çƒ­é—¨æ–‡ç« 
function loadPopularArticles() {
    const lg = new URLSearchParams(window.location.search).get('lg') || 'zh-cn';
    const isEnglish = lg === 'en';
    
    // æ›´æ–°æ ‡é¢˜
    document.getElementById('popular-articles-title').textContent = isEnglish ? 'Popular Psychology Articles' : 'çƒ­é—¨å¿ƒç†å­¦æ–‡ç« ';
    
    // è·å–çƒ­é—¨æ–‡ç« 
    fetch('/addons/cms/psychometry/getPopularArticles?limit=8&lang=' + lg)
        .then(response => response.json())
        .then(data => {
            if (data.code === 1 && data.data && data.data.length > 0) {
                displayPopularArticles(data.data, isEnglish);
            } else {
                // å¦‚æœAPIä¸å­˜åœ¨æˆ–æ²¡æœ‰æ•°æ®ï¼Œéšè—è¯¥åŒºåŸŸ
                document.querySelector('.popular-articles-section')?.classList.add('hidden');
            }
        })
        .catch(error => {
            console.log('åŠ è½½çƒ­é—¨æ–‡ç« :', error);
            // APIä¸å­˜åœ¨æ—¶éšè—è¯¥åŒºåŸŸ
            document.querySelector('.popular-articles-section')?.classList.add('hidden');
        });
}

// æ˜¾ç¤ºçƒ­é—¨æ–‡ç« 
function displayPopularArticles(articles, isEnglish) {
    const container = document.getElementById('popular-articles-content');
    let html = '';
    
    articles.forEach(article => {
        const title = article.title || '';
        const description = article.description || article.excerpt || '';
        const views = article.views || article.view_count || 0;
        const url = article.url || `/article/${article.id}`;
        const imageUrl = article.image || article.cover || '';
        const publishTime = article.publish_time || article.createtime || '';
        
        html += `
            <a href="${url}" class="group overflow-hidden rounded-2xl border border-gray-200 bg-white shadow-sm transition hover:-translate-y-0.5 hover:shadow-md" title="${title}">
                <div class="aspect-[16/9] bg-gradient-to-br from-rose-500 to-orange-500">
                    ${imageUrl ? `<img src="${imageUrl}" alt="${title}" class="h-full w-full object-cover" loading="lazy">` : ''}
                </div>
                <div class="p-4">
                    <h3 class="text-sm font-semibold text-gray-900">${title}</h3>
                    <p class="mt-2 text-sm text-gray-600">${description}</p>
                    <div class="mt-4 flex items-center justify-between text-xs text-gray-500">
                        <span class="inline-flex items-center gap-1">
                            <i class="fas fa-eye" aria-hidden="true"></i>
                            ${views.toLocaleString()}
                        </span>
                        <span class="inline-flex items-center gap-1">
                            <i class="far fa-clock" aria-hidden="true"></i>
                            ${formatDate(publishTime, isEnglish)}
                        </span>
                    </div>
                </div>
            </a>
        `;
    });
    
    container.innerHTML = html;
}

// æ ¼å¼åŒ–æ—¥æœŸ
function formatDate(timestamp, isEnglish) {
    if (!timestamp) return '';
    
    const date = new Date(timestamp * 1000);
    const now = new Date();
    const diffTime = Math.abs(now - date);
    const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));
    
    if (diffDays < 1) {
        return isEnglish ? 'Today' : 'ä»Šå¤©';
    } else if (diffDays < 7) {
        return isEnglish ? `${diffDays} days ago` : `${diffDays}å¤©å‰`;
    } else if (diffDays < 30) {
        const weeks = Math.floor(diffDays / 7);
        return isEnglish ? `${weeks} weeks ago` : `${weeks}å‘¨å‰`;
    } else {
        return date.toLocaleDateString(isEnglish ? 'en-US' : 'zh-CN', { 
            year: 'numeric', 
            month: 'short', 
            day: 'numeric' 
        });
    }
}

// æŠ˜å åŠŸèƒ½
function toggleTestInfo() {
    const content = document.getElementById('info-content');
    const icon = document.getElementById('test-info-icon');
    
    if (!content || !icon) {
        console.error('æ— æ³•æ‰¾åˆ°æµ‹è¯•ä¿¡æ¯å…ƒç´ ');
        return;
    }

    if (content.classList.contains('hidden')) {
        content.classList.remove('hidden');
        icon.textContent = 'â–²';
    } else {
        content.classList.add('hidden');
        icon.textContent = 'â–¼';
    }
}

// é€šç”¨æŠ˜å åŠŸèƒ½
function toggleSection(sectionName) {
    const content = document.getElementById(sectionName + '-content');
    const icon = document.getElementById(sectionName + '-icon');
    
    if (!content || !icon) {
        console.error('æ— æ³•æ‰¾åˆ°æŠ˜å å…ƒç´ ', sectionName);
        return;
    }

    if (content.classList.contains('hidden')) {
        content.classList.remove('hidden');
        icon.classList.add('rotate-180');
    } else {
        content.classList.add('hidden');
        icon.classList.remove('rotate-180');
    }
}

// ç»´åº¦å†…å®¹æŠ˜å åŠŸèƒ½
function toggleDimensionContent(header) {
    const dimBody = header.nextElementSibling;
    const toggleIcon = header.querySelector('.dim-toggle');
    
    if (!dimBody || !toggleIcon) {
        console.error('æ— æ³•æ‰¾åˆ°ç»´åº¦æŠ˜å å…ƒç´ ');
        return;
    }

    if (dimBody.classList.contains('hidden')) {
        dimBody.classList.remove('hidden');
        toggleIcon.classList.add('rotate-180');
    } else {
        dimBody.classList.add('hidden');
        toggleIcon.classList.remove('rotate-180');
    }
}

// åˆ›å»ºé›·è¾¾å›¾
let radarChart = null;
function createRadarChart(dimensionArray) {
    const canvas = document.getElementById('dimensionRadarChart');
    if (!canvas) return;
    
    // é”€æ¯æ—§å›¾è¡¨
    if (radarChart) {
        radarChart.destroy();
    }
    
    // è·å–è¯­è¨€è®¾ç½®
    const urlParams = new URLSearchParams(window.location.search);
    const lg = urlParams.get('lg') || 'zh-cn';
    const isEnglish = lg === 'en';
    
    // å‡†å¤‡æ•°æ® - ç¿»è¯‘ç»´åº¦åç§°
    const labels = dimensionArray.map(dim => {
        let name = dim.name;
        // å¦‚æœæ˜¯è‹±æ–‡ç‰ˆä¸”åç§°åŒ…å«ä¸­æ–‡ï¼Œè¿›è¡Œç¿»è¯‘
        if (isEnglish && /[\u4e00-\u9fa5]/.test(name)) {
            name = translateDimensionName(name);
        }
        return name;
    });
    const scores = dimensionArray.map(dim => dim.score);
    const maxScores = dimensionArray.map(dim => dim.max_score || 15);
    const maxPossible = Math.max(...maxScores);
    
    // é¢„å®šä¹‰é¢œè‰²
    const colorPalette = [
        'rgba(52, 152, 219, 0.7)',   // è“è‰²
        'rgba(155, 89, 182, 0.7)',   // ç´«è‰²
        'rgba(231, 76, 60, 0.7)',    // çº¢è‰²
        'rgba(46, 204, 113, 0.7)',   // ç»¿è‰²
        'rgba(243, 156, 18, 0.7)',   // æ©™è‰²
        'rgba(26, 188, 156, 0.7)',   // é’è‰²
        'rgba(230, 126, 34, 0.7)',   // æ·±æ©™
        'rgba(22, 160, 133, 0.7)',   // æ·±é’
        'rgba(192, 57, 43, 0.7)'     // æ·±çº¢
    ];
    
    const ctx = canvas.getContext('2d');
    radarChart = new Chart(ctx, {
        type: 'radar',
        data: {
            labels: labels,
            datasets: [{
                label: isEnglish ? 'Score' : 'å¾—åˆ†',
                data: scores,
                backgroundColor: 'rgba(102, 126, 234, 0.2)',
                borderColor: 'rgba(102, 126, 234, 1)',
                borderWidth: 2,
                pointBackgroundColor: colorPalette.slice(0, dimensionArray.length),
                pointBorderColor: '#fff',
                pointHoverBackgroundColor: '#fff',
                pointHoverBorderColor: 'rgba(102, 126, 234, 1)',
                pointRadius: 6,
                pointHoverRadius: 8
            }]
        },
        options: {
            responsive: true,
            maintainAspectRatio: true,
            scales: {
                r: {
                    beginAtZero: true,
                    max: maxPossible,
                    ticks: {
                        stepSize: Math.ceil(maxPossible / 5),
                        font: {
                            size: 12
                        }
                    },
                    pointLabels: {
                        font: {
                            size: 14,
                            weight: '600'
                        },
                        color: '#2c3e50'
                    },
                    grid: {
                        color: 'rgba(0, 0, 0, 0.1)'
                    },
                    angleLines: {
                        color: 'rgba(0, 0, 0, 0.1)'
                    }
                }
            },
            plugins: {
                legend: {
                    display: false
                },
                tooltip: {
                    callbacks: {
                        label: function(context) {
                            const dim = dimensionArray[context.dataIndex];
                            return `${dim.name}: ${dim.score}/${dim.max_score} (${Math.round(dim.score/dim.max_score*100)}%)`;
                        }
                    }
                }
            }
        }
    });
}
</script>
